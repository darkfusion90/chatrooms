(this.webpackJsonpchatrooms=this.webpackJsonpchatrooms||[]).push([[0],{235:function(e,t,n){e.exports=n(410)},304:function(e,t,n){},307:function(e,t,n){},308:function(e,t,n){},309:function(e,t,n){},310:function(e,t,n){},328:function(e,t,n){},368:function(e,t,n){},369:function(e,t,n){},370:function(e,t,n){},371:function(e,t,n){},372:function(e,t,n){},373:function(e,t,n){},401:function(e,t){},404:function(e,t,n){},405:function(e,t,n){},406:function(e,t,n){},407:function(e,t,n){},408:function(e,t,n){},409:function(e,t,n){},410:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),o=n(26),i=n.n(o),s=n(23),c=n(9),l=n(190),m=n(188),u={connected:!1},d=n(61),p=n(17),f=n(62),g=n.n(f),b=function(e,t){var n=t.roomId,r=t.updatedMembers;return Object(p.a)({},e,Object(d.a)({},n,Object(p.a)({},e[n],{members:r})))},v=function(e,t){return Object(p.a)({},e,Object(d.a)({},t.roomId,t))},h={length:0,data:{}},E={isLoggedIn:!1,user:{}},y={isModalOpen:!1,modalName:null,modalProps:null},O={sortBy:"name-asc",itemsPerPage:10,currentPageNumber:1,searchQuery:null},R=n(74),j={activeToasts:[]},S=Object(s.c)({user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:E,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGIN":return{isLoggedIn:!0,user:t.payload.user};case"LOGOUT":return E;case"REGISTER":return{isLoggedIn:!1,user:t.payload};case"UPDATE_USER":return Object(p.a)({},e,{},t.payload);default:return e}},serverConnection:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u,t=arguments.length>1?arguments[1]:void 0;return"CONNECT_TO_SERVER"===t.type?{connected:t.payload.connected}:e},rooms:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"FETCH_PUBLIC_ROOMS":return Object(p.a)({},e,{},g.a.mapKeys(t.payload,"roomId"));case"FETCH_ROOM":return v(e,t.payload);case"DELETE_ROOM":return g.a.omit(e,t.payload);case"LEAVE_ROOM":case"JOIN_ROOM":return b(e,t.payload);case"UPDATE_ROOM":return v(e,t.payload);default:return e}},roomListDisplaySettings:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_ROOM_LIST_SORT_TECHNIQUE":return Object(p.a)({},e,{sortBy:t.payload});case"SET_ROOM_LIST_ITEMS_PER_PAGE":return Object(p.a)({},e,{itemsPerPage:t.payload});case"SET_ROOM_LIST_CURRENT_PAGE":return Object(p.a)({},e,{currentPageNumber:t.payload});case"SET_ROOM_LIST_SEARCH_QUERY":return Object(p.a)({},e,{searchQuery:t.payload});default:return e}},notifications:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"FETCH_ALL_NOTIFICATIONS":var n=t.payload;return Object(p.a)({},e,{length:n.length,data:g.a.mapKeys(n,"_id")});case"UPDATE_NOTIFICATION":var r=t.payload;return Object(p.a)({},e,{data:Object(p.a)({},e.data,Object(d.a)({},r._id,r))});default:return e}},form:m.a,modal:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:y,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SHOW_MODAL":return Object(p.a)({isModalOpen:!0},t.payload);case"HIDE_MODAL":return y;default:return e}},toast:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:j,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SHOW_TOAST":return{activeToasts:g.a.uniq([].concat(Object(R.a)(e.activeToasts),[t.payload.name]))};case"HIDE_TOAST":var n=t.payload.name;return{activeToasts:e.activeToasts.filter((function(e){return e!==n}))};default:return e}}}),P=n(10),I=n(11),C=n(13),N=n(12),w=n(14),F=n(29),U=n(56),k=n(412),_=n(7),A=n(68),M=function(e){var t=e.showModal,n=e.modalName,r=e.modalProps,o=e.component,i=e.children,s=Object(_.a)(e,["showModal","modalName","modalProps","component","children"]),c=o;return a.a.createElement(c,Object.assign({onClick:function(){return t(n,r)}},s),i)},T=function(e){return{type:"HIDE_MODAL"}},L=Object(c.b)(null,{showModal:function(e,t){return{type:"SHOW_MODAL",payload:{modalName:e,modalProps:t}}}})((function(e){return a.a.createElement(M,e)})),x=L,D=function(e){var t=e.to,n=e.shouldUseReplace,r=e.component,o=e.children,i=Object(_.a)(e,["to","shouldUseReplace","component","children"]),s=r,c=Object(U.g)();return a.a.createElement(s,Object.assign({onClick:function(){return n?c.replace(t):c.push(t)}},i),o)},J=function(e){var t=e.component,n=e.children,r=Object(_.a)(e,["component","children"]);return a.a.createElement(x,Object.assign({modalName:"CreateRoom",component:t||A.a},r),n)},B=function(e){var t=e.component,n=e.children,r=Object(_.a)(e,["component","children"]);return a.a.createElement(x,Object.assign({modalName:"JoinRoom",component:t||A.a},r),n)},V=function(e){var t=e.component,n=e.children,r=e.room,o=Object(_.a)(e,["component","children","room"]);return a.a.createElement(x,Object.assign({modalName:"DeleteRoom",modalProps:{room:r},component:t||A.a,variant:"danger"},o),n)},q=(n(304),function(){return a.a.createElement("div",{className:"landing-page compensate-header w-100"},a.a.createElement("div",{className:"d-flex flex-column align-items-center"},a.a.createElement("p",{className:"welcome-msg"},"Welcome to ChatRooms!"),a.a.createElement(k.a,null,a.a.createElement(J,null,"Create Room"),a.a.createElement(B,{variant:"outline-primary"},"Join Room By Id"))))}),H=q,G=n(418),Q=n(204),z=n(416),Y=n(27),W=n.n(Y),X=n(20),K=n(18),Z=n(137),$=function(e){var t=!e.dismissAction;return a.a.createElement(Z.a,{show:e.show,variant:e.variant,onClose:e.onDismiss,dismissible:t},a.a.createElement(Z.a.Heading,null,e.heading),a.a.createElement("p",null,e.body),a.a.createElement("div",{className:"d-flex justify-content-end"},e.dismissAction&&e.dismissAction()))},ee=n(110),te=n(113),ne=function(e){return a.a.createElement(ee.a,{trigger:"click",placement:"bottom",rootClose:!0,overlay:a.a.createElement(te.a,null,a.a.createElement(te.a.Title,{as:"h2"},e.title),a.a.createElement(te.a.Content,null,e.menu))},e.triggerComponent)},re=n(196),ae=function(e){var t=e.triggerComponent,n=e.label,r=e.id,o=Object(_.a)(e,["triggerComponent","label","id"]);return a.a.createElement(ee.a,Object.assign({trigger:"hover",placement:"bottom",rootClose:!0,overlay:a.a.createElement(re.a,{id:r},n)},o),t)},oe=n(198),ie=n(197),se=n.n(ie),ce=(n(307),function(e){function t(){return Object(P.a)(this,t),Object(C.a)(this,Object(N.a)(t).apply(this,arguments))}return Object(w.a)(t,e),Object(I.a)(t,[{key:"componentDidMount",value:function(){se()(this.textareaRef)}},{key:"render",value:function(){var e=this;return a.a.createElement(oe.a,Object.assign({},this.props,this.props.input,{as:"textarea",rows:"1",className:"text-input-wrap",ref:function(t){return e.textareaRef=t}}))}}]),t}(a.a.Component)),le=ce,me=n(209),ue=n(199),de=n(413),pe=function(e){var t=e.formProps,n=e.error,o=Object(r.useState)(!1),i=Object(me.a)(o,2),s=i[0],c=i[1];return a.a.createElement(a.a.Fragment,null,a.a.createElement(ue.a,null,t.label),a.a.createElement(de.a,null,a.a.createElement(oe.a,Object.assign({},t,t.input,{type:s?"text":"password"})),a.a.createElement(de.a.Append,{onClick:function(){c(!s)},style:{cursor:"pointer"}},a.a.createElement(de.a.Text,null,a.a.createElement(X.a,{icon:s?K.f:K.g})))),a.a.createElement(oe.a,Object.assign({},t,t.input,{style:{display:"none"}})),a.a.createElement(oe.a.Feedback,{type:"invalid"},n))},fe=function(e){var t=e.label,n=Object(_.a)(e,["label"]);return a.a.createElement(A.a,n,t||"Initial")},ge=n(415),be=n(414),ve=n(200),he=function(e){var t=e.icon,n=e.iconPos,r=e.children,o=(e.childrenProps,Object(_.a)(e,["icon","iconPos","children","childrenProps"])),i=0===n;return a.a.createElement(A.a,o,a.a.createElement(be.a,null,i?a.a.createElement(ve.a,null,t):null,a.a.createElement(ve.a,{className:i?"pl-0":"pr-0",style:{whiteSpace:"nowrap"}},r),1===n?a.a.createElement(ve.a,null,t):null))},Ee=function(e){var t=e.icon,n=e.iconPos,r=e.label,o=Object(_.a)(e,["icon","iconPos","label"]);return a.a.createElement(he,Object.assign({icon:t||a.a.createElement(ge.a,{animation:"border",size:"sm"}),iconPos:n||0,style:{cursor:"not-allowed"},variant:"info",disabled:!0},o),r||"Pending")},ye=function(e){var t=e.icon,n=e.iconPos,r=e.label,o=Object(_.a)(e,["icon","iconPos","label"]);return a.a.createElement(he,Object.assign({icon:t||a.a.createElement(X.a,{icon:K.c}),iconPos:n||0,style:{cursor:"not-allowed"},variant:"success",disabled:!0},o),r||"Initial")},Oe=function(e){var t=e.icon,n=e.iconPos,r=e.label,o=Object(_.a)(e,["icon","iconPos","label"]);return a.a.createElement(he,Object.assign({icon:t||a.a.createElement(X.a,{icon:K.n}),iconPos:n||0,style:{cursor:"not-allowed"},variant:"danger",disabled:!0},o),r||"Initial")},Re="prog_success",je="prog_fail",Se=function(e){var t=e.progress,n=e.propsProgressInitial,r=e.propsProgressPending,o=e.propsProgressSuccess,i=e.propsProgressFailure,s=Object(_.a)(e,["progress","propsProgressInitial","propsProgressPending","propsProgressSuccess","propsProgressFailure"]);switch(t){case"prog_init":return a.a.createElement(fe,Object.assign({},n,s));case"prog_pending":return a.a.createElement(Ee,Object.assign({},r,s));case Re:return a.a.createElement(ye,Object.assign({},o,s));case je:return a.a.createElement(Oe,Object.assign({},i,s));default:return a.a.createElement(fe,Object.assign({label:"Click Here"},s))}},Pe=Se,Ie=function(e,t){e.navigate;var n=Object(_.a)(e,["navigate"]);return a.a.createElement(t,n)},Ce=n(139),Ne=n(201),we=function(e){var t=e.invitation,n=e.notificationId;return a.a.createElement(x,{modalName:"ReviewRoomInvitation",modalProps:{invitation:t,notificationId:n},component:function(e){var t=e.children,n=Object(_.a)(e,["children"]);return a.a.createElement("div",n,t)}},a.a.createElement("h6",{className:"mb-1 mt-0"},"Room Invitation"),function(e){var t=e.inviter,n=e.room,r=t&&t.username,o=n&&n.name;return a.a.createElement("p",{className:"mb-0"},a.a.createElement("em",null,r)," ","invited you to join the room"," ",a.a.createElement("em",null,o))}(t))},Fe=we,Ue=(n(308),function(e){var t=e.notification;return a.a.createElement(Ne.a,{className:"m-0 notification-item"},function(e){var t=e.roomInvitation,n=e._id;if(t)return a.a.createElement(Fe,{invitation:t,notificationId:n})}(t))}),ke=Ue,_e=(n(309),function(e){var t=e.notifications;return a.a.createElement(Ce.a,{variant:"flush",className:"notification-list"},0===t.length?"You don't have any notifications":t.map((function(e){return a.a.createElement(ke,{key:e._id,notification:e})})))}),Ae=_e,Me=function(e){if(!e)return 0;var t=Object.keys(e.data),n=[];return t.forEach((function(t){var r=e.data[t];"pending"===r.status&&n.push(r)})),n},Te=(n(310),function(e){var t=e.notifications;console.log("all notifs: ",t);var n=Me(t);console.log("pending notifs: ",n);return a.a.createElement(ne,{title:a.a.createElement("p",{className:"m-0"},"Notifications",W()(n)?"":" (".concat(n.length,")")),menu:a.a.createElement(Ae,{notifications:n}),triggerComponent:function(){var e=n.length>0,t=e?"visible":"hidden",r=e?"active":"inactive";return a.a.createElement("div",{className:"notification-icon-container"},a.a.createElement(X.a,{icon:K.a,size:"lg",className:"notification-bell-icon ".concat(r)}),a.a.createElement(X.a,{icon:K.d,size:"xs",color:"red",className:"notification-badge ".concat(t)}))}()})}),Le=Object(c.b)((function(e){return{notifications:e.notifications}}))((function(e){var t=e.notifications;return a.a.createElement(Te,{notifications:t})})),xe=Le,De=function(e){var t=e.username,n=e.logoutUser,r=a.a.createElement(X.a,{icon:K.o,size:"lg"}),o=a.a.createElement("span",null,"Signed in as ",a.a.createElement("strong",null,t));return a.a.createElement(ne,{title:o,menu:a.a.createElement("div",{className:"d-flex flex-column align-items-center"},a.a.createElement(A.a,{variant:"outline-secondary",onClick:n},"Sign Out")),triggerComponent:r})},Je=n(22),Be=n.n(Je),Ve=n(203),qe=n.n(Ve),He=qe.a.create({withCredentials:!0}),Ge=function(e,t,n,r,a){return He.post("/api/register",{username:e,password:t,confirmPassword:n}).then(r,a)},Qe=function(e,t,n,r){return He.post("/api/login",{username:e,password:t}).then(n,r)},ze=function(e,t,n){return He.get("/api/user/".concat(e,"/?byUsername=true")).then(t,n)},Ye=function(e,t,n){return He.get("/api/rooms/".concat(e)).then(t,n)},We=function(e,t,n,r){return He.post("/api/rooms",{roomName:e,roomType:t}).then(n,r)},Xe=function(e,t,n){return He.delete("/api/rooms/".concat(e)).then(t,n)},Ke=function(e,t,n){return He.patch("/api/notifications/".concat(e),{status:"reviewed"}).then(t).catch(n)},Ze=function(e,t,n,r){return He.post("/api/room_invitations",{invitee:e,roomId:t}).then(n).catch(r)},$e=function(e,t,n){return He.post("/api/room_invitations/".concat(e,"/accept")).then(t).catch(n)},et=function(e,t){var n,r;n=function(n){var r=e.data,a=n.data.isLoggedIn;t(function(e,t){return{type:"UPDATE_USER",payload:{isLoggedIn:e,user:t}}}(a,r))},r=function(e){var t=e.response;return console.log("Check user status fail: ",t)},He.get("/api/user/status/login").then(n,r)},tt=Object(c.b)((function(e){var t=e.user;return{username:t.user&&t.user.username}}),{logoutUser:function(){return function(e){return Be.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:n=function(){return e({type:"LOGOUT"})},r=function(e){var t=e.response;return console.log("Logout Failed: ",t)},He.post("/api/logout").then(n,r);case 1:case"end":return t.stop()}var n,r}))}}})((function(e){var t=e.username,n=e.logoutUser;return a.a.createElement(De,{username:t,logoutUser:n})})),nt=tt,rt=(n(328),a.a.createElement(F.b,{to:"/register",component:function(e){return Ie(e,A.a)}},"Register")),at=a.a.createElement(F.b,{to:"/login",component:function(e){return Ie(e,A.a)},variant:"outline-primary"},"Login"),ot=function(e){var t=e.isUserRegistered,n=e.isUserLoggedIn,r=function(e){return a.a.createElement(G.a.Item,{className:"mx-3 cursor-pointer"},e)};return a.a.createElement(Q.a,{className:"header-navbar-container",fluid:!0},a.a.createElement(z.a,{expand:"large",sticky:"top"},a.a.createElement(z.a.Brand,null,a.a.createElement(F.b,{to:"/",className:"brand"}," ChatRooms ")),a.a.createElement(G.a,{className:"flex-row"},a.a.createElement(Q.a,null,a.a.createElement(G.a.Item,{className:"mx-3"},a.a.createElement(F.b,{to:"/rooms",component:function(e){return Ie(e,G.a.Link)},className:"header-text"},"Rooms")),a.a.createElement(G.a.Item,{className:"mx-3 cursor-pointer"},a.a.createElement(xe,null)),n?null:r(at),t?null:r(rt),n&&t?r(a.a.createElement(nt,null)):null))))},it=Object(c.b)((function(e){var t=e.user;return{isUserLoggedIn:t.isLoggedIn,isUserRegistered:t.user&&t.user.isRegistered}}))((function(e){var t=e.isUserRegistered,n=e.isUserLoggedIn;return a.a.createElement(ot,{isUserRegistered:t,isUserLoggedIn:n})})),st=it,ct=function(e){return a.a.createElement("div",null,a.a.createElement(st,null),a.a.createElement("div",{className:"centered-content"},e))},lt=function(e){return ct(a.a.createElement(H,e))},mt=lt,ut=n(419),dt=n(205),pt=n(186),ft=n(187),gt=function(e){var t=e.meta.error,n=function(e){var t=e.meta,n=t.touched,r=t.error,a=t.pristine,o=n&&r;return Object(p.a)({},e,{},e.input,{isInvalid:o,isValid:!a&&!o})}(e);return"password"===e.type?a.a.createElement(pe,{formProps:n,error:t}):a.a.createElement(a.a.Fragment,null,a.a.createElement(ut.a.Label,null,e.label),a.a.createElement(oe.a,n),a.a.createElement(oe.a.Feedback,{type:"invalid"},t))},bt=Object(ft.a)({form:"loginForm",validate:function(e){var t={};return e.username||(t.username="Username is required"),e.password||(t.password="Password is required"),t}})((function(e){return a.a.createElement(ut.a,{onSubmit:e.handleSubmit(e.onFormSubmit)},a.a.createElement(dt.a,{controlId:"formUsernameGroup"},a.a.createElement(pt.a,{component:gt,name:"username",type:"text",label:"Enter Username",placeholder:"Example: mitsy_the_cat"})),a.a.createElement(dt.a,{controlId:"formPasswordGroup"},a.a.createElement(pt.a,{component:gt,name:"password",type:"password",label:"Enter Password",placeholder:"Password"})),a.a.createElement(A.a,{type:"submit"},"Login"))})),vt=(n(368),function(e){return e.isUserLoggedIn?a.a.createElement(U.a,{to:"/"}):function(e){var t=e.shouldShowErrorAlert,n=e.errorReason,r=e.onErrorAlertDismissed,o=e.onFormSubmit;return a.a.createElement(Q.a,{className:"compensate-header"},a.a.createElement("div",{className:"centered-content login-container"},!1,a.a.createElement($,{variant:"danger",heading:"Login Unsuccessful",body:n,show:t,onDismiss:r}),a.a.createElement(bt,{onFormSubmit:o})))}(e)}),ht=function(e){function t(){var e,n;Object(P.a)(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(n=Object(C.a)(this,(e=Object(N.a)(t)).call.apply(e,[this].concat(a)))).onFormSubmit=function(e){n.props.loginUser(e.username,e.password,n.props.onLoginFailure)},n}return Object(w.a)(t,e),Object(I.a)(t,[{key:"render",value:function(){var e=this.props,t=e.shouldShowErrorAlert,n=e.errorReason,r=e.onErrorAlertDismissed,o=e.isUserLoggedIn;return a.a.createElement(vt,{isUserLoggedIn:o,errorReason:n,shouldShowErrorAlert:t,onErrorAlertDismissed:r,onFormSubmit:this.onFormSubmit})}}]),t}(a.a.Component),Et=Object(c.b)((function(e){return{isUserLoggedIn:e.user.isLoggedIn}}),{loginUser:function(e,t,n){return function(r){return Be.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:Qe(e,t,(function(e){r({type:"LOGIN",payload:{user:e.data}})}),n);case 2:case"end":return a.stop()}}))}}})(ht),yt=function(e){function t(){var e,n;Object(P.a)(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(n=Object(C.a)(this,(e=Object(N.a)(t)).call.apply(e,[this].concat(a)))).state={errorReason:null,shouldShowErrorAlert:!1},n.onLoginFailure=function(e){var t=e.response;n.setState({errorReason:t.data.reason,shouldShowErrorAlert:!0})},n.onErrorAlertDismissed=function(){n.setState({shouldShowErrorAlert:!1})},n}return Object(w.a)(t,e),Object(I.a)(t,[{key:"render",value:function(){return a.a.createElement(Et,Object.assign({onLoginFailure:this.onLoginFailure,onErrorAlertDismissed:this.onErrorAlertDismissed},this.state))}}]),t}(a.a.Component),Ot=yt,Rt=Ot,jt=function(e){return ct(a.a.createElement(Rt,e))},St=jt,Pt=function(e){var t=e.meta.error,n=function(e){var t=e.meta,n=t.touched,r=t.error,a=t.pristine,o=t.asyncValidating,i=function(e){return"That username is already taken"===e}(r)||n&&r;return Object(p.a)({},e,{},e.input,{className:o?"input-loading":"",isInvalid:i,isValid:!o&&!a&&!i})}(e);return"password"===e.type?a.a.createElement(pe,{formProps:n,error:t}):a.a.createElement(a.a.Fragment,null,a.a.createElement(ut.a.Label,null,e.label),a.a.createElement(oe.a,n),a.a.createElement(oe.a.Feedback,{type:"invalid"},t))},It=function(e){var t=e.onFormSubmit,n=e.isRegisterButtonDisabled,r=n?"not-allowed":"cursor";return a.a.createElement(ut.a,{noValidate:!0,id:"registration-form",onSubmit:t},a.a.createElement(dt.a,{controlId:"formUsernameGroup"},a.a.createElement(pt.a,{component:Pt,name:"username",type:"text",label:"Enter Username",placeholder:"Example: mitsy_the_cat"})),a.a.createElement(dt.a,{controlId:"formPasswordGroup"},a.a.createElement(pt.a,{component:Pt,name:"password",type:"password",label:"Enter Password",placeholder:"Password"})),a.a.createElement(dt.a,{controlId:"formConfirmPasswordGroup"},a.a.createElement(pt.a,{component:Pt,name:"confirmPassword",type:"password",label:"Confirm Password",placeholder:"Confirm Password"})),a.a.createElement(A.a,{type:"submit",form:"registration-form",className:"cursor-".concat(r),disabled:n},"Register"))},Ct=Object(ft.a)({form:"registerForm",validate:function(e){var t=e.username,n=e.password,r=e.confirmPassword,a={};if(t||(a.username="Username cannot be empty"),n||(a.password="Password cannot be empty"),r){if(function(e,t){return e!==t}(n,r)){var o="Confirm Password and Password must match";a.confirmPassword=o,a.password=o}}else a.confirmPassword="Confirm Password cannot be empty";return a},asyncValidate:function(e,t){return new Promise((function(t,n){return ze(e.username,(function(e){200===e.status?n({username:"That username is already taken"}):t()}))}))},asyncChangeFields:["username"]})((function(e){var t=e.handleSubmit,n=e.onFormSubmit,r=Object(_.a)(e,["handleSubmit","onFormSubmit"]),o=r.pristine,i=r.submitting,s=r.asyncValidating,c=r.invalid,l=o||i||s||c;return a.a.createElement(It,{isRegisterButtonDisabled:l,onFormSubmit:t(n)})})),Nt=Ct,wt=function(e){var t=e.onFormSubmit,n=e.isUserLoggedIn,r=e.isUserRegistered;return n||r?function(){var e=a.a.createElement(U.a,{to:"/"}),t=a.a.createElement(U.a,{to:{pathname:"/login",state:{isRedirectFromSuccessfulRegister:!0}}});return n?e:r?n?e:t:void 0}():a.a.createElement("div",{className:"centered-content"},a.a.createElement(Q.a,null,a.a.createElement(Nt,{onFormSubmit:t})))},Ft=function(e){function t(){var e,n;Object(P.a)(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(n=Object(C.a)(this,(e=Object(N.a)(t)).call.apply(e,[this].concat(a)))).onRegistrationFailed=function(e){var t=e.response;console.log("Registration failed: ",t)},n.onFormSubmit=function(e){console.log("Registration Form Values: ",e),n.props.registerUser(e.username,e.password,e.confirmPassword,n.onRegistrationFailed)},n}return Object(w.a)(t,e),Object(I.a)(t,[{key:"render",value:function(){var e=this.props,t=e.isUserLoggedIn,n=e.isUserRegistered;return a.a.createElement(wt,{isUserLoggedIn:t,isUserRegistered:n,onFormSubmit:this.onFormSubmit})}}]),t}(a.a.Component),Ut=Object(c.b)((function(e){return{isUserRegistered:e.user.user&&e.user.user.isRegistered,isUserLoggedIn:e.user.isLoggedIn}}),{registerUser:function(e,t,n,r){return function(a){return Be.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:Ge(e,t,n,(function(e){return a({type:"REGISTER",payload:e.data})}),r);case 1:case"end":return o.stop()}}))}}})(Ft),kt=Ut,_t=function(e){return ct(a.a.createElement(kt,e))},At=_t,Mt=n(25),Tt=(n(369),function(e){return a.a.createElement(le,e)}),Lt=function(e){var t=e.onFormSubmit,n=e.formId;return a.a.createElement(ut.a,{onSubmit:t,id:n,className:"chat-message-form"},a.a.createElement(Q.a,{className:"d-flex align-items-center",fluid:!0},a.a.createElement("div",{className:"textarea-flex-container"},a.a.createElement(ut.a.Group,{controlId:"message",className:"textarea-wrapper"},a.a.createElement(pt.a,{name:"message",placeholder:"Type a message...",type:"text",component:Tt}))),a.a.createElement("div",{className:"send-btn-flex-container"},a.a.createElement(A.a,{type:"submit",form:n,variant:"outline-primary"},"Send"))))},xt="chat-message-form",Dt=Object(ft.a)({form:xt,onSubmitSuccess:function(e,t){t(Object(Mt.b)(xt))}})((function(e){var t=e.handleSubmit,n=e.onFormSubmit;return a.a.createElement(Lt,{onFormSubmit:t(n),formId:xt})})),Jt=Dt,Bt=(n(370),function(e){var t=e.message,n=e.align,r=e.color,o=e.isCurrentUserMessageAuthor;if(!t)return null;var i=o?"You":t.author&&t.author.username?t.author.username:"<unknown-user>",s=function(){var e="left"===n?{borderRight:"15px solid #0c5460"}:{borderLeft:"15px solid #0c5460"};return a.a.createElement("p",{className:"msg-box-arrow ".concat(n),style:e})}();return a.a.createElement(Q.a,{className:"message float-".concat(n)},"left"===n&&s,a.a.createElement("p",{style:{color:r},className:"mb-0"},a.a.createElement("strong",null,i)),a.a.createElement("p",{className:"mb-0"},t.data),"right"===n&&s)}),Vt=function(e){function t(){var e,n;Object(P.a)(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(n=Object(C.a)(this,(e=Object(N.a)(t)).call.apply(e,[this].concat(a)))).isCurrentUserMessageAuthor=function(){var e=n.props,t=e.message,r=e.userId;return t&&t.author&&t.author._id===r},n}return Object(w.a)(t,e),Object(I.a)(t,[{key:"render",value:function(){var e=this.props,t=e.message,n=e.color;if(!t)return null;var r=this.isCurrentUserMessageAuthor()?"right":"left";return a.a.createElement(Bt,{message:t,align:r,color:n,isCurrentUserMessageAuthor:this.isCurrentUserMessageAuthor()})}}]),t}(a.a.Component),qt=Object(c.b)((function(e){return{userId:e.user.user._id}}),null)(Vt),Ht=qt,Gt=(n(371),function(e){var t=e.room,n=e.colorsAssignedToMessageAuthors;return a.a.createElement(Ce.a,{className:"chat-window pre-scrollable",variant:"flush"},function(){var e;return t.messages.map((function(r){var o=r.author&&r.author._id,i=o===e?"pt-0":"";return e=o,a.a.createElement(Ce.a.Item,{key:r&&r._id,className:"border-0 ".concat(i," pb-1")},a.a.createElement(Ht,{color:n[o],roomId:t.roomId,message:r}))}))}())}),Qt=["#fff07c","#80ff72","#7ee8fa","#eec0c6","#e58c8a"],zt=function(e){return Qt.length===e.length},Yt=function(e,t){return-1!==e.indexOf(t)},Wt=function(e){var t={},n=[];return e.forEach((function(e){if(!t[e]){var r=function(e){var t;do{var n=Math.floor(Math.random()*Qt.length);t=Qt[n]}while(Yt(e,t)&&!zt(e));return t}(n);t[e]=r,zt(n)||n.push(r)}})),t},Xt=function(e){function t(){var e,n;Object(P.a)(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(n=Object(C.a)(this,(e=Object(N.a)(t)).call.apply(e,[this].concat(a)))).state={randomAuthorColors:[]},n}return Object(w.a)(t,e),Object(I.a)(t,[{key:"componentDidMount",value:function(){this.props.room&&this.setState({randomAuthorColors:this.assignRandomColorsToMessageAuthors()})}},{key:"assignRandomColorsToMessageAuthors",value:function(){var e=this.props.room.messages.map((function(e){return e.author&&e.author._id}));return Wt(e)}},{key:"render",value:function(){var e=this.props.room,t=this.state.randomAuthorColors;return e?a.a.createElement(Gt,{room:e,colorsAssignedToMessageAuthors:t}):null}}]),t}(a.a.Component),Kt=Xt,Zt=Kt,$t=(n(372),function(e){var t=e.room,n=e.className;return a.a.createElement(Q.a,{fluid:!0,className:"room-page-sub-header ".concat(n)},a.a.createElement("div",{className:"d-flex align-items-center h-100"},a.a.createElement("div",{className:"room-name-container text-overflow-ellipses"},t.name),a.a.createElement("div",{className:"room-actions-container"},a.a.createElement("div",{className:"d-flex justify-content-around"},[{tooltipLabel:"Leave Room",tooltipId:"tooltip-leave-room",Component:a.a.createElement(x,{component:X.a,icon:K.m,className:"cursor-pointer",modalName:"LeaveRoom",modalProps:{room:t}})},{tooltipLabel:"Invite User",tooltipId:"tooltip-invite-user",Component:a.a.createElement(x,{component:X.a,icon:K.i,className:"cursor-pointer",modalName:"InviteUser",modalProps:{room:t}})},{tooltipLabel:"Close Room Window",tooltipId:"tooltip-close-room",Component:a.a.createElement(D,{component:X.a,icon:K.p,className:"cursor-pointer",to:"/rooms"})}].map((function(e){var t=e.tooltipId,n=e.tooltipLabel,r=e.Component;return a.a.createElement(ae,{triggerComponent:r,label:n,id:t,key:t})}))))))}),en=$t,tn=function(e,t,n){return function(r){(function(e,t,n){return He.post("/api/rooms/".concat(e,"/members")).then(t,n)})(e).then((function(n){var a=n.data;r({type:"JOIN_ROOM",payload:{roomId:e,updatedMembers:a.members}}),t()})).catch(n)}},nn=function(e){var t=e.progress,n=e.propsProgressInitial,r=e.propsProgressPending,o=e.propsProgressSuccess,i=e.propsProgressFailure,s=e.defaultProps,c=Object(_.a)(e,["progress","propsProgressInitial","propsProgressPending","propsProgressSuccess","propsProgressFailure","defaultProps"]);return a.a.createElement(Pe,Object.assign({progress:t},function(){var e=n&&Object(p.a)({},n),t=r&&Object(p.a)({},r),a=o&&Object(p.a)({},o),c=i&&Object(p.a)({},i);return{propsProgressInitial:Object(p.a)({},s.initial,{},e),propsProgressPending:Object(p.a)({},s.pending,{},t),propsProgressSuccess:Object(p.a)({},s.success,{},a),propsProgressFailure:Object(p.a)({},s.fail,{},c)}}(),c))},rn=function(e){return a.a.createElement(nn,Object.assign({defaultProps:{initial:{label:"Create Room"},pending:{label:"Creating Room..."},success:{label:"Room Created"},fail:{label:"Error Creating Room"}}},e))},an=function(e){return a.a.createElement(nn,Object.assign({defaultProps:{initial:{label:"Delete Room"},pending:{label:"Deleting Room..."},success:{label:"Room Deleted"},fail:{label:"Error Deleting Room"}}},e))},on=function(e){return a.a.createElement(nn,Object.assign({defaultProps:{initial:{label:"Join Room"},pending:{label:"Joining Room..."},success:{label:"Room Joined"},fail:{label:"Error Joining Room"}}},e))},sn=function(e){return a.a.createElement(nn,Object.assign({defaultProps:{initial:{label:"Leave Room"},pending:{label:"Leaving Room..."},success:{label:"Room Left"},fail:{label:"Error Leaving Room"}}},e))},cn=function(e){return a.a.createElement(nn,Object.assign({defaultProps:{initial:{label:"Send Join Request"},pending:{label:"Sending Request..."},success:{label:"Request Sent"},fail:{label:"Error Sending Request"}}},e))},ln=function(e){return a.a.createElement(nn,Object.assign({defaultProps:{initial:{label:"Send Invitation"},pending:{label:"Sending Invitation..."},success:{label:"Invitation Sent"},fail:{label:"Error Sending Invitation"}}},e))},mn=function(e){return a.a.createElement(nn,Object.assign({defaultProps:{initial:{label:"Accept"},pending:{label:"Accepting Invitation..."},success:{label:"Accepted"},fail:{label:"Error Accepting Invitation"}}},e))},un=function(e){var t=e.room,n=e.joinRoomProgress,r=e.onJoinRoomButtonClick;if(console.log("room: ",t),!t)return null;var o="private"===t.type,i=o?"send a join request":"join the room";return a.a.createElement(Q.a,{fluid:!0,className:"centered-content h-100"},a.a.createElement("div",{className:"d-flex flex-column justify-content-between align-items-center mx-auto"},a.a.createElement(X.a,{icon:K.k,size:"5x",color:"#b7b9ba",className:"mb-4"}),a.a.createElement("h4",null,"You are not a member of this room"),a.a.createElement("p",{className:" h-100 subtitle"},"To access, you must ",i),a.a.createElement(k.a,null,o?a.a.createElement("div",null,"Send a request"):function(e,t){return a.a.createElement(on,{progress:e,propsProgressInitial:{onClick:t}})}(n,r),a.a.createElement(F.b,{to:"/rooms",className:"btn btn-outline-secondary"},"Back to Rooms"))))},dn=function(e){function t(){var e,n;Object(P.a)(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(n=Object(C.a)(this,(e=Object(N.a)(t)).call.apply(e,[this].concat(a)))).state={joinRoomProgress:"prog_init"},n.onJoinRoomButtonClick=function(){n.onJoinRoomPending();var e=n.props,t=e.room;(0,e.joinRoom)(t&&t.roomId,n.onJoinRoomSuccess,n.onJoinRoomFail)},n.onJoinRoomPending=function(){n.setState({joinRoomProgress:"prog_pending"})},n.onJoinRoomSuccess=function(){n.setState({joinRoomProgress:Re})},n.onJoinRoomFail=function(){n.setState({joinRoomProgress:je})},n}return Object(w.a)(t,e),Object(I.a)(t,[{key:"render",value:function(){return a.a.createElement(un,Object.assign({onJoinRoomButtonClick:this.onJoinRoomButtonClick},this.props,this.state))}}]),t}(a.a.Component),pn=dn,fn=Object(c.b)(null,{joinRoom:tn})((function(e){return a.a.createElement(pn,e)})),gn=fn,bn=(n(373),function(e,t,n){return a.a.createElement("div",{className:"d-flex flex-column room-content-container"},function(e,t){return a.a.createElement(a.a.Fragment,null,a.a.createElement(en,{room:e,className:"room-content-header"}),a.a.createElement("div",{className:"room-content-body"},a.a.createElement(Zt,{room:e})),a.a.createElement("div",{className:"room-content-footer"},a.a.createElement(Jt,{onFormSubmit:t})))}(e,t))}),vn=function(e){var t=e.error,n=e.room,r=e.currentUser,o=e.onSendMessageButtonClick;return t?function(e){return e.status,a.a.createElement("div",null,"Unexpected Error")}(t):n?function(e,t){return!!(e&&e.members&&t)&&-1!==e.members.findIndex((function(e){return e.user&&e.user._id===t}))}(n,r&&r._id)?bn(n,o):a.a.createElement(gn,{room:n}):a.a.createElement("div",{className:"centered-content"},a.a.createElement("h2",null,"Please wait while the Room is loading..."),a.a.createElement(ge.a,{size:"lg",animation:"border"}))},hn=n(206),En=n.n(hn),yn="event:room",On="connect_to_room",Rn="event:message",jn="send_message",Sn="event:notification",Pn="new_notification",In=En()("/",{autoConnect:!1}),Cn=function(e){In.connect(),In.on("connect_error",e)},Nn=function(e,t,n,r){!function(e,t,n,r){He.post("/api/rooms/".concat(e,"/messages"),{message:t}).then(n,r)}(e,t,(function(t){!function(e,t){In.emit(Rn,jn,e,t)}(e,t._id),n(t)}),r)},wn=function(e){function t(){var e,n;Object(P.a)(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(n=Object(C.a)(this,(e=Object(N.a)(t)).call.apply(e,[this].concat(a)))).state={error:null},n.onRoomFetchFail=function(e){var t=e.response;n.setState({error:t})},n.onSendMessageButtonClick=function(e){var t=e.message;if(!t||0===t.trim().length)return null;var r=n.props.room;Nn(r.roomId,t,n.onSendMessageSuccess,n.onSendMessageFailure)},n.onSendMessageSuccess=function(e){n.setState({room:e.data})},n.onSendMessageFailure=function(e){var t=e.response;n.setState({error:t})},n}return Object(w.a)(t,e),Object(I.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.fetchRoom,r=t.roomId;console.log("roomId: ",r),function(e,t){In.on(Rn,(function(){for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];console.log("Message Event: ",r);var o=r[0];if(o===jn){var i=r[1];i.roomId===e&&t(i)}}))}(r,(function(t){console.log("new message: ",t),n(r,e.onRoomFetchSuccess,e.onRoomFetchFail)})),n(r,(function(){}),this.onRoomFetchFail)}},{key:"componentDidUpdate",value:function(){var e,t,n=this.props.room;n&&(e=n.roomId,t=function(){},In.emit(yn,On,e,t))}},{key:"render",value:function(){var e=this.props,t=e.currentUser,n=e.room;return a.a.createElement(vn,Object.assign({currentUser:t,room:n,onSendMessageButtonClick:this.onSendMessageButtonClick},this.state))}}]),t}(a.a.Component),Fn=wn,Un=Object(c.b)((function(e,t){return{currentUser:e.user&&e.user.user,room:e.rooms[t.roomId]}}),{fetchRoom:function(e,t,n){return function(r){Ye(e).then((function(e){var n=e.data;t(n),r({type:"FETCH_ROOM",payload:n})})).catch(n)}}})((function(e){return a.a.createElement(Fn,e)})),kn=Un,_n=(n(404),function(e,t){return a.a.createElement(Q.a,{fluid:!0,className:"d-flex flex-column align-items-center"},a.a.createElement("div",{className:"title empty-room-list-title"},e),a.a.createElement("div",{className:"subtitle empty-room-list-subtitle"},t))}),An=function(e){var t=e.isSearchResult;return a.a.createElement(Q.a,{className:"centered-content compensate-header"},t?_n("No rooms matching your search query","Try checking spelling and other possible errors, if any"):function(){var e=a.a.createElement(k.a,null,a.a.createElement(J,{size:"sm",className:"empty-room-list-subtitle"},"Create a room"),a.a.createElement(B,{size:"sm",variant:"outline-primary",className:"empty-room-list-subtitle"},"Join a room by Id"));return _n("There are no public rooms available",e)}())},Mn=An,Tn=function(e){var t=e.room,n=e.isCurrentUserRoomMember,r=e.isCurrentUserRoomAdmin,o=Object(_.a)(e,["room","isCurrentUserRoomMember","isCurrentUserRoomAdmin"]);return n?a.a.createElement(k.a,null,function(e){var t=e.roomId?e.roomId:"";return a.a.createElement(F.b,{to:"/rooms/".concat(t),className:"btn btn-outline-primary"},"Open")}(t),r?function(e){return a.a.createElement(V,{room:e},"Delete")}(t):null):function(){var e=o.joinRoomProgress,n=o.onJoinRoomButtonClick;return function(e,t){return a.a.createElement(on,{progress:e,propsProgressInitial:{label:"Join",onClick:t}})}(e,(function(){return n(t?t.roomId:"")}))}()},Ln=function(e){function t(){var e,n;Object(P.a)(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(n=Object(C.a)(this,(e=Object(N.a)(t)).call.apply(e,[this].concat(a)))).getMemberReferenceOfCurrentUser=function(){var e=n.props,t=e.room,r=e.currentUser;if(!t||!r)return null;return t.members.find((function(e){return e&&e.user&&e.user._id===r._id}))},n.isCurrentUserRoomMember=function(e){return!W()(e)},n.isCurrentUserRoomAdmin=function(e){return!!n.isCurrentUserRoomMember(e)&&"admin"===e.memberType},n}return Object(w.a)(t,e),Object(I.a)(t,[{key:"render",value:function(){var e=this.getMemberReferenceOfCurrentUser();return a.a.createElement(Tn,Object.assign({isCurrentUserRoomMember:this.isCurrentUserRoomMember(e),isCurrentUserRoomAdmin:this.isCurrentUserRoomAdmin(e)},this.props))}}]),t}(a.a.Component),xn=Object(c.b)((function(e){return{currentUser:e.user.user,isUserLoggedIn:e.user.isLoggedIn}}))(Ln),Dn=function(e){if(!e)return"<unknown>";var t=new Date(e);return function(e,t){if(e<t){throw new Error("[ISODateToReadableString.getAppropriateTimeDifferenceText] First date argument must be greater than the second argument")}var n=function(e,t){var n=e.getYear()-t.getYear();if(n>0)return{unit:n>1?"years":"year",difference:n};var r=e.getMonth()-t.getMonth();if(r>0)return{unit:r>1?"months":"month",difference:r};var a=e.getDate()-t.getDate();if(a>0)return{unit:a>1?"days":"day",difference:a};var o=e.getHours()-t.getHours();if(o>0)return{unit:o>1?"hrs":"hr",difference:o};var i=e.getMinutes()-t.getMinutes();if(i>0)return{unit:i>1?"mins":"min",difference:i};var s=e.getSeconds()-t.getSeconds();return s>0?{unit:s>1?"secs":"sec",difference:s}:void 0}(e,t);return n?"".concat(n.difference).concat(n.unit," ago"):"just now"}(new Date,t)},Jn=function(e){var t=e.room,n=e.onJoinRoomButtonClick,r=e.joinRoomProgress;Object(_.a)(e,["room","onJoinRoomButtonClick","joinRoomProgress"]);if(!t)return null;return a.a.createElement(Ne.a,{className:"px-0"},a.a.createElement(Q.a,{fluid:!0,className:"d-flex flex-row justify-content-between"},a.a.createElement("div",{className:"text-overflow-ellipses"},a.a.createElement("h5",{className:"max-width-100 text-overflow-ellipses"},a.a.createElement(F.b,{to:"/rooms/".concat(t.roomId)},t.name)),function(){var e=t.createdBy,n=e?e.username:"<unknown>",r=Dn(t.createdAt);return a.a.createElement("span",{className:"max-width-100 subtitle"},"Created ",r," by ",n)}()),a.a.createElement("div",null,a.a.createElement(xn,{room:t,onJoinRoomButtonClick:n,joinRoomProgress:r}))))},Bn=function(e){function t(){var e,n;Object(P.a)(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(n=Object(C.a)(this,(e=Object(N.a)(t)).call.apply(e,[this].concat(a)))).state={joinRoomProgress:"prog_init"},n.onJoinRoomPending=function(){n.setState({joinRoomProgress:"prog_pending"})},n.onJoinRoomSuccess=function(){n.setState({joinRoomProgress:Re})},n.onJoinRoomFailure=function(){n.setState({joinRoomProgress:je})},n.onJoinRoomButtonClick=function(e){n.onJoinRoomPending(),n.props.joinRoom(e,n.onJoinRoomSuccess,n.onJoinRoomFailure)},n}return Object(w.a)(t,e),Object(I.a)(t,[{key:"render",value:function(){return a.a.createElement(Jn,Object.assign({onJoinRoomButtonClick:this.onJoinRoomButtonClick},this.state,this.props))}}]),t}(a.a.Component),Vn=Object(c.b)(null,{joinRoom:tn})((function(e){return a.a.createElement(Bn,e)})),qn=n(75),Hn=[{label:"By name (ascending)",value:"name-asc",id:"sort-by-name-asc"},{label:"By name (descending)",value:"name-des",id:"sort-by-name-des"},{label:"By date of creation (oldest first)",value:"date-asc",id:"sort-by-date-asc"},{label:"By date of creation (newest first)",value:"date-des",id:"sort-by-date-des"}],Gn=[{label:"All Rooms",value:"no-filter",id:"filter-none"},{label:"Joined Rooms",value:"is-member",id:"filter-member"},{label:"Rooms Not Joined",value:"is-not-Member",id:"filter-not-member"},{label:"Rooms Created By Me",value:"user-created",id:"filter-user-created"},{label:"Rooms Not Created By Me",value:"user-not-created",id:"filter-user-not-created"}],Qn=function(e){function t(){var e,n;Object(P.a)(this,t);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return(n=Object(C.a)(this,(e=Object(N.a)(t)).call.apply(e,[this].concat(o)))).renderRadioButton=function(e){var t=e.input,n=Object(_.a)(e,["input"]);return a.a.createElement(qn.a,Object.assign({},n,t))},n.renderInputRangedNumber=function(e){var t=e.input,n=e.label,r=Object(_.a)(e,["input","label"]);return a.a.createElement(a.a.Fragment,null,a.a.createElement(ut.a.Label,null,n),a.a.createElement(oe.a,Object.assign({},t,r)))},n}return Object(w.a)(t,e),Object(I.a)(t,[{key:"renderSortOptions",value:function(){var e=this,t=Hn.map((function(t){var n=t.id,r=Object(_.a)(t,["id"]);return a.a.createElement(pt.a,Object.assign({component:e.renderRadioButton,type:"radio",name:"sortBy",key:n,required:!0},r))}));return a.a.createElement(dt.a,{controlId:"sort-options"},a.a.createElement(ut.a.Label,null,"Sort By: "),t)}},{key:"renderPaginationControls",value:function(){return a.a.createElement(dt.a,{controlId:"items-per-page"},a.a.createElement(pt.a,{component:this.renderInputRangedNumber,name:"itemsPerPage",label:"Rooms Displayed Per Page: ",type:"number",min:1,max:100}))}},{key:"renderDisplayFilters",value:function(){var e=this;return a.a.createElement(dt.a,{controlId:"display-filter"},a.a.createElement(ut.a.Label,null,"Filter Rooms: "),Gn.map((function(t){var n=t.id,r=Object(_.a)(t,["id"]);return a.a.createElement(pt.a,Object.assign({component:e.renderRadioButton,type:"radio",name:"displayFilter",key:n},r))})))}},{key:"render",value:function(){var e=this.props,t=e.handleSubmit,n=e.onFormSubmit;return a.a.createElement(ut.a,{id:"rooms-sort-form",onSubmit:t(n)},this.renderSortOptions(),a.a.createElement("hr",null),this.renderPaginationControls(),a.a.createElement("hr",null),this.renderDisplayFilters(),a.a.createElement(Q.a,{fluid:!0,className:"text-right"},a.a.createElement(A.a,{size:"sm",variant:"outline-primary",type:"submit",form:"rooms-sort-form"},"Done")))}}]),t}(a.a.Component),zn=Object(ft.a)({form:"rooms-sort-form",initialValues:{sortBy:"name-asc",itemsPerPage:10,displayFilter:"no-filter"},destroyOnUnmount:!1})(Qn),Yn=function(e){var t=e.onDisplayControlsFormSubmit;return a.a.createElement(ne,{menu:a.a.createElement(zn,{onFormSubmit:function(e){document.body.click(),t(e)}}),triggerComponent:a.a.createElement(he,{icon:a.a.createElement(X.a,{icon:K.h}),iconPos:0,className:"no-highlight-around-element",variant:"secondary",size:"sm"},"Filter"),show:!0})},Wn=function(e){var t=e.onSearchFieldInputChange;return a.a.createElement(de.a,{className:"rounded"},a.a.createElement(de.a.Prepend,null,a.a.createElement(de.a.Text,null,a.a.createElement(X.a,{icon:K.l}))),a.a.createElement(oe.a,{name:"searchQuery",placeholder:"Search Rooms",onChange:t}))},Xn=function(e){var t=e.paginationItemsPerPage,n=e.onDisplayControlsFormSubmit,r=e.onSearchFieldInputChange;return a.a.createElement(Q.a,{fluid:!0,className:"room-page-sub-header d-flex align-items-center justify-content-between px-sm-0 mx-sm-0"},a.a.createElement(Q.a,{fluid:!0},a.a.createElement(Yn,{paginationItemsPerPage:t,onDisplayControlsFormSubmit:n})),a.a.createElement(Q.a,{fluid:!0},a.a.createElement(Wn,{onSearchFieldInputChange:r})))},Kn=n(420),Zn=function(e){var t=e.totalRooms,n=e.itemsPerPage,r=e.currentPageNumber,o=e.setCurrentPageNumber,i=Math.ceil(t.length/n);return a.a.createElement(Q.a,{fluid:!0,className:"d-flex flex-column align-items-center mt-5"},a.a.createElement("p",null,"Showing Page ",r," of ",i),a.a.createElement(Kn.a,{className:"mx-auto"},a.a.createElement(ae,{label:"First page",id:"pagination-first",triggerComponent:a.a.createElement(Kn.a.First,{onClick:function(){o(1)}})}),a.a.createElement(ae,{triggerComponent:a.a.createElement(Kn.a.Prev,{onClick:function(){o(Math.max(r-1,1))}}),label:"Previous Page",id:"pagination-prev"}),function(){for(var e=[],t=function(t){e.push(a.a.createElement(Kn.a.Item,{active:r===t,key:t,id:t,onClick:function(){o(t)}},t))},n=1;n<=i;n++)t(n);if(e.length>10){var s=function(e,t){var n=function(e){return e-1<4?0:e-1-4}(e),r=function(e){return e-1+4}(e),a={left:n,right:r};return 0!==n&&r>=t&&(a.left-=r+1-(t-1)),0===n&&(a.right+=5-(e-1)),{leftOffset:a.left,rightOffset:a.right}}(r,e.length),c=s.leftOffset,l=s.rightOffset,m=[l<e.length?a.a.createElement(Kn.a.Ellipsis,{key:"ellipsis-right"}):null],u=[c>0?a.a.createElement(Kn.a.Ellipsis,{key:"ellipsis-left"}):null];return[].concat(u,Object(R.a)(e.slice(c,l+1)),m)}return e}(),a.a.createElement(ae,{triggerComponent:a.a.createElement(Kn.a.Next,{onClick:function(){o(Math.min(r+1,i))}}),label:"Next Page",id:"pagination-next"}),a.a.createElement(ae,{triggerComponent:a.a.createElement(Kn.a.Last,{onClick:function(){o(i)}}),label:"Last Page",id:"pagination-last"})))},$n=function(e){var t=e.roomsToDisplay,n=e.isSearchResult,r=e.onDisplayControlsFormSubmit,o=e.onSearchFieldInputChange,i=e.setCurrentPageNumber,s=Object(_.a)(e,["roomsToDisplay","isSearchResult","onDisplayControlsFormSubmit","onSearchFieldInputChange","setCurrentPageNumber"]);return a.a.createElement(Q.a,{fluid:!0,className:"pb-5 mb-5"},a.a.createElement(Xn,{onDisplayControlsFormSubmit:r,onSearchFieldInputChange:o}),W()(t)?a.a.createElement(Mn,{isSearchResult:n}):a.a.createElement(Ce.a,{variant:"flush",className:"mx-0 mt-3"},t.map((function(e){return a.a.createElement(Vn,{room:e,key:e.roomId})}))),W()(t)?null:a.a.createElement(Zn,Object.assign({},s,{setCurrentPageNumber:function(e){i(e)}})))},er=function(e,t){return e&&e.name?t&&t.name?e.name.localeCompare(t.name):e?1:-1:t?-1:1},tr=function(e,t){return e&&e.createdAt?t&&t.createdAt?e.createdAt.localeCompare(t.createdAt):e?1:-1:t?-1:1},nr=new(function(){function e(t){Object(P.a)(this,e),this.loggerKey=t}return Object(I.a)(e,[{key:"debug",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];(e=console).log.apply(e,[this.loggerKey].concat(n))}}]),e}())("[RoomListContainer] "),rr=function(e){function t(){var e,n;Object(P.a)(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(n=Object(C.a)(this,(e=Object(N.a)(t)).call.apply(e,[this].concat(a)))).onRoomFetchFail=function(e){var t=e.response;nr.debug("RoomList fetch fail: ",t)},n.getSortedRoomList=function(e){var t=n.props.roomListDisplaySettings.sortBy;if(!e)return[];switch(t){case"name-des":return e.sort(er).reverse();case"date-asc":return e.sort(tr);case"date-des":return e.sort(tr).reverse();case"name-asc":default:return e.sort(er)}},n.onDisplayControlsFormSubmit=function(e){var t=e.sortBy,r=e.itemsPerPage;n.props.setSortTechnique(t),n.props.setItemsPerPage(r)},n.onSearchFieldInputChange=function(e){n.props.setSearchQuery(e.target.value)},n.getPaginatedRoomList=function(e){var t=n.props.roomListDisplaySettings,r=t.itemsPerPage,a=t.currentPageNumber;if(e.length<=r)return e;var o=r*(a-1),i=Math.min(o+r,e.length);return e.slice(o,i)},n.getSearchQuery=function(){var e=n.props.roomListDisplaySettings.searchQuery;return e&&e.toLowerCase().trim()},n.filterRoomListBySearchQuery=function(e,t){return t?e.filter((function(e){var n=e&&e.name;return n&&n.toLowerCase().includes(t)})):e},n.getRooms=function(e){var t=Object(R.a)(n.props.rooms);return n.getSortedRoomList(n.filterRoomListBySearchQuery(t,e))},n}return Object(w.a)(t,e),Object(I.a)(t,[{key:"componentDidMount",value:function(){this.props.fetchPublicRooms(this.onRoomFetchFail)}},{key:"render",value:function(){var e=this.props,t=e.roomListDisplaySettings,n=e.setCurrentPageNumber,r=this.getSearchQuery(),o=this.getRooms(r),i=this.getPaginatedRoomList(o);return a.a.createElement($n,Object.assign({totalRooms:o,roomsToDisplay:i,isSearchResult:!W()(r),onDisplayControlsFormSubmit:this.onDisplayControlsFormSubmit,onSearchFieldInputChange:this.onSearchFieldInputChange,setCurrentPageNumber:n},t))}}]),t}(a.a.Component),ar={fetchPublicRooms:function(e){return function(t){return Be.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:r=function(e){t({type:"FETCH_PUBLIC_ROOMS",payload:e.data})},a=e,He.get("/api/rooms").then(r,a);case 1:case"end":return n.stop()}var r,a}))}},setSortTechnique:function(e){return{type:"SET_ROOM_LIST_SORT_TECHNIQUE",payload:e}},setCurrentPageNumber:function(e){return{type:"SET_ROOM_LIST_CURRENT_PAGE",payload:e}},setSearchQuery:function(e){return{type:"SET_ROOM_LIST_SEARCH_QUERY",payload:e}},setItemsPerPage:function(e){return{type:"SET_ROOM_LIST_ITEMS_PER_PAGE",payload:e}}},or=Object(c.b)((function(e){return{rooms:Object.values(e.rooms),roomListDisplaySettings:e.roomListDisplaySettings}}),ar)(rr),ir=(n(405),function(e){if(e)return a.a.createElement(ve.a,function(e){var t=e?{xs:12,sm:12,className:"h-100"}:{};return Object(p.a)({},{xl:7,lg:7,md:7},{},t)}(e),a.a.createElement(kn,{roomId:e,key:e}))}),sr=function(e){var t=e.match.params.id,n=a.a.createElement(Q.a,{fluid:!0,className:"pl-0 pr-0 room-page-container"},a.a.createElement(be.a,{className:"mx-0 no-gutters h-100"},function(e){return a.a.createElement(ve.a,function(e){return e?{xl:5,lg:5,md:5,sm:0,xs:0,className:"d-none d-md-block ".concat("overflow-auto h-100")}:{className:"overflow-auto h-100"}}(e),a.a.createElement(or,null))}(t),ir(t)));return ct(n)},cr=function(){return a.a.createElement(F.a,null,a.a.createElement(U.d,null,a.a.createElement(U.b,{exact:!0,path:"/",component:mt}),a.a.createElement(U.b,{exact:!0,path:"/rooms/:id?",component:sr}),a.a.createElement(U.b,{exact:!0,path:"/login",component:St}),a.a.createElement(U.b,{exact:!0,path:"/register",component:At})))},lr=function(e){return e.serverConnectionFailed?a.a.createElement("div",{className:"centered-content"},"Cannot Connect To Server"):a.a.createElement(cr,null)},mr=function(e){function t(){var e,n;Object(P.a)(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(n=Object(C.a)(this,(e=Object(N.a)(t)).call.apply(e,[this].concat(a)))).state={serverConnectionFailed:!1},n.onServerConnected=function(){n.setState({serverConnectionFailed:!1})},n.onServerDisconnected=function(){n.setState({serverConnectionFailed:!0})},n.onNewNotification=function(){n.props.showNewNotificationToast(),n.props.fetchAllNotifications()},n}return Object(w.a)(t,e),Object(I.a)(t,[{key:"componentDidMount",value:function(){var e;this.props.connectToServer(this.onServerDisconnected),e=this.onServerDisconnected,In.on("disconnect",e),function(e){In.on("connect",e)}(this.onServerConnected),function(e){console.log("registered"),In.on(Sn,(function(t){console.log("on notif event: ",t),t===Pn&&e()}))}(this.onNewNotification),this.props.updateUser(),this.props.fetchAllNotifications()}},{key:"componentDidUpdate",value:function(e){var t=e.user,n=this.props.user;(t&&t._id)!==(n&&n._id)&&this.props.fetchAllNotifications()}},{key:"render",value:function(){return a.a.createElement(lr,Object.assign({},this.state,this.props))}}]),t}(a.a.Component),ur={connectToServer:function(e){return function(t){return Be.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Be.a.awrap(Cn(e));case 2:t({type:"CONNECT_TO_SERVER",payload:{connected:!0}});case 3:case"end":return n.stop()}}))}},updateUser:function(){return function(e){return Be.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:n=function(t){return et(t,e)},r=function(e){var t=e.response;return console.log("Get current user fail: ",t)},He.get("/api/user/").then(n,r);case 1:case"end":return t.stop()}var n,r}))}},fetchAllNotifications:function(){return function(e){return Be.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:n=function(t){var n=t.data;console.log("actions notif: ",n),e({type:"FETCH_ALL_NOTIFICATIONS",payload:n})},r=function(e){var t=e.response;return console.log("notification fetch failed: ",t)},He.get("/api/notifications").then(n,r);case 2:case"end":return t.stop()}var n,r}))}},showNewNotificationToast:function(){return{type:"SHOW_TOAST",payload:{name:"NewNotification"}}}},dr=Object(c.b)((function(e){var t=e.user;return{user:t&&t.user}}),ur)((function(e){return a.a.createElement(mr,e)})),pr=n(76),fr=function(e){var t=e.visible,n=e.hideModal,r=e.header,o=e.content,i=e.actions;return a.a.createElement(pr.a,{show:t,onHide:n,centered:!0},a.a.createElement(pr.a.Header,{closeButton:!0,onHide:n},a.a.createElement(pr.a.Title,null,r)),a.a.createElement(pr.a.Body,null,o),a.a.createElement(pr.a.Footer,null,i))},gr=(n(406),function(e){var t=e.input,n=e.meta,r=n.touched&&n.error,o=!n.pristine&&!r,i=[{label:"Private",value:"private"},{label:"Public",value:"public"},{label:"Unlisted",value:"unlisted"}].map((function(e){return a.a.createElement(ut.a.Group,{controlId:"roomType-".concat(e.value),key:e.value},a.a.createElement(de.a,null,a.a.createElement(ut.a.Check,Object.assign({},t,e,{type:"radio",isInvalid:r,isValid:o})),a.a.createElement(de.a.Append,null,function(e){var t=function(e){var t=a.a.createElement(X.a,{icon:K.j});return a.a.createElement(ae,Object.assign({triggerComponent:t},e))};switch(e){case"private":return t({id:"private-room-opt",label:"Private rooms require permission to join and are not listed publicly"});case"unlisted":return t({id:"private-room-opt",label:"Unlisted rooms can be joined by anyone but are not listed publicly"});case"public":return t({id:"private-room-opt",label:"Public rooms are listed publicly and can be joined by anyone"})}}(e.value))))}));return a.a.createElement(ut.a.Group,{controlId:"create-room-form-type"},a.a.createElement(ut.a.Label,null,a.a.createElement("strong",null,"Select Room Type:")),i,r&&a.a.createElement(Z.a,{variant:"danger"},n.error))}),br=function(e){var t=e.input,n=e.meta,r=n.touched&&n.error,o=!n.pristine&&!r;return a.a.createElement(dt.a,{controlId:"create-room-form-name"},a.a.createElement(ut.a.Label,null,a.a.createElement("strong",null,e.label)),a.a.createElement(oe.a,Object.assign({},e,t,{isInvalid:r,isValid:o})),a.a.createElement(ut.a.Control.Feedback,{size:"lg",type:"invalid"},n.error))},vr=function(e){var t=e.onFormSubmit;return a.a.createElement(ut.a,{noValidate:!0,id:"create-room-form",onSubmit:t},a.a.createElement(pt.a,{component:br,name:"roomName",label:"Enter Room Name:",placeholder:"Example: The Mystical Room",required:!0}),a.a.createElement("hr",null),a.a.createElement(pt.a,{component:gr,name:"roomType"}))},hr=Object(ft.a)({form:"createRoomForm",validate:function(e){var t={};return e.roomName||(t.roomName="Room name cannot be empty"),e.roomType||(t.roomType="Please choose one of the room types above"),t}})((function(e){var t=e.handleSubmit,n=e.onFormSubmit;return a.a.createElement(vr,{onFormSubmit:t(n)})})),Er=function(e){var t=e.isModalVisible,n=e.hideModal,r=e.createRoomFormData,o=e.createRoomProgress,i=e.onFormSubmit;return a.a.createElement(fr,{header:"Create Room",actions:function(){var e=r&&r.syncErrors;return a.a.createElement(a.a.Fragment,null,a.a.createElement(A.a,{variant:"secondary",onClick:n},"Cancel"),a.a.createElement(rn,{progress:o,form:"create-room-form",type:"submit",disabled:e,className:"cursor-".concat(e?"not-allowed":"pointer")}))}(),content:a.a.createElement(hr,{onFormSubmit:i}),visible:t,hideModal:n})},yr=function(e){function t(){var e,n;Object(P.a)(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(n=Object(C.a)(this,(e=Object(N.a)(t)).call.apply(e,[this].concat(a)))).state={createRoomProgress:"prog_init"},n.onCreateRoomPending=function(){n.setState({createRoomProgress:"prog_pending"})},n.onCreateRoomSuccess=function(){n.setState({createRoomProgress:Re})},n.onCreateRoomFailure=function(){n.setState({createRoomProgress:je})},n.onFormSubmit=function(e){var t=e.roomName,r=e.roomType;n.onCreateRoomPending(),(0,n.props.createRoom)(t,r,n.onCreateRoomSuccess,n.onCreateRoomFailure)},n}return Object(w.a)(t,e),Object(I.a)(t,[{key:"render",value:function(){return a.a.createElement(Er,Object.assign({onFormSubmit:this.onFormSubmit},this.state,this.props))}}]),t}(a.a.Component),Or=Object(c.b)((function(e){return{isModalVisible:e.modal.isModalOpen&&"CreateRoom"===e.modal.modalName,createRoomFormData:e.form.createRoomForm}}),{createRoom:function(e,t,n,r){return function(a){return Be.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:We(e,t,(function(e){a({type:"CREATE_ROOM",payload:e.data}),n()}),r);case 1:case"end":return o.stop()}}))}},hideModal:T})((function(e){return a.a.createElement(yr,e)})),Rr=function(e){var t=e.input,n=e.label,r=e.meta,o=e.roomAlreadyJoinedError,i=Object(_.a)(e,["input","label","meta","roomAlreadyJoinedError"]),s=r.touched,c=r.error,l=r.pristine,m=r.asyncValidating,u=c&&c.isAsyncValidationError||s&&c||o,d=o||c&&(c.isAsyncValidationError?c.reason:c);return a.a.createElement(dt.a,{controlId:"join-room"},a.a.createElement(ue.a,null,n),a.a.createElement(oe.a,Object.assign({className:m?"input-loading":"",isValid:!m&&!l&&!u,isInvalid:u},t,i)),a.a.createElement(oe.a.Feedback,{type:"invalid"},d))},jr=function(e){return W()(e)?"RoomId is required":void 0},Sr=function(e){var t=e.onFormSubmit,n=e.roomAlreadyJoinedError;return a.a.createElement(ut.a,{id:"join-room-form",onSubmit:t},a.a.createElement(pt.a,{component:Rr,name:"roomId",label:"Enter Room Id",placeholder:"X-X-X-X",roomAlreadyJoinedError:n,validate:jr}))},Pr=function(e,t){return{roomId:{reason:e,isAsyncValidationError:!0,isPrivateRoomError:t}}},Ir=Object(ft.a)({form:"joinRoomForm",asyncValidate:function(e){return new Promise((function(t,n){if(W()(e.roomId))return n(Pr("No rooms matching that roomId"));Ye(e.roomId).then(t).catch((function(e){var t=e.response;n(function(e){switch(e.status){case 403:return Pr("This is a private room. You need to send a join request",!0);case 404:return Pr("No rooms matching that roomId");default:return Pr("Some error ocurred; Please try again after sometime")}}(t))}))}))},asyncChangeFields:["roomId"]})((function(e){var t=e.handleSubmit,n=e.onFormSubmit,r=e.roomAlreadyJoinedError;return a.a.createElement(Sr,{onFormSubmit:t(n),roomAlreadyJoinedError:r})})),Cr=function(e){var t=e.roomAlreadyJoinedError,n=e.isModalVisible,r=e.hideModal,o=e.onFormSubmit,i=e.joinRoomFormData,s=e.joinRoomProgress;return a.a.createElement(fr,{header:"Join Room By Id",actions:a.a.createElement(a.a.Fragment,null,a.a.createElement(A.a,{onClick:r,variant:"outline-secondary"},"Cancel"),function(){var e=i&&i.asyncErrors,n=i&&(i.syncErrors||e||i.asyncValidating)||t,r={type:"submit",form:"join-room-form",disabled:n,className:"cursor-".concat(n?"not-allowed":"pointer")};return e&&e.roomId.isPrivateRoomError?a.a.createElement(cn,{progress:s,propsProgressInitial:r}):a.a.createElement(on,{progress:s,propsProgressInitial:r})}()),content:a.a.createElement(Ir,{onFormSubmit:o,roomAlreadyJoinedError:t}),visible:n,hideModal:r})},Nr=function(e){function t(){var e,n;Object(P.a)(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(n=Object(C.a)(this,(e=Object(N.a)(t)).call.apply(e,[this].concat(a)))).state={joinRoomProgress:"prog_init",roomAlreadyJoinedError:null},n.onJoinRoomPending=function(){n.setState({joinRoomProgress:"prog_pending"})},n.onJoinRoomSuccess=function(){n.setState({joinRoomProgress:Re})},n.onJoinRoomFailure=function(){n.setState({joinRoomProgress:je})},n.onJoinRoomFormSubmit=function(e){var t=e.roomId;n.onJoinRoomPending(),n.props.joinRoom(t,n.onJoinRoomSuccess,n.onJoinRoomFailure)},n}return Object(w.a)(t,e),Object(I.a)(t,[{key:"componentDidUpdate",value:function(){var e=this;if(!this.state.roomAlreadyJoinedError){var t=this.props,n=t.joinRoomFormData,r=t.currentUserId,a=n||{};if(!(a.syncErrors||a.asyncErrors||a.asyncValidating)){var o=a.values&&a.values.roomId;Ye(o).then((function(t){(function(e,t){return!!(e&&e.members&&t)&&-1!==e.members.findIndex((function(e){return e.user&&e.user._id===t}))})(t.data,r)&&e.setState({roomAlreadyJoinedError:"You are already a member of this room"})})).catch()}}}},{key:"render",value:function(){return a.a.createElement(Cr,Object.assign({onFormSubmit:this.onJoinRoomFormSubmit},this.props,this.state))}}]),t}(a.a.Component),wr=Object(c.b)((function(e){var t=e.user;return{isModalVisible:e.modal.isModalOpen&&"JoinRoom"===e.modal.modalName,joinRoomFormData:e.form.joinRoomForm,currentUserId:t&&t.user&&t.user._id}}),{hideModal:T,joinRoom:tn})((function(e){return a.a.createElement(Nr,e)})),Fr=function(e){var t=e.input,n=e.label,r=Object(_.a)(e,["input","label"]);return a.a.createElement(dt.a,{controlId:"delete-room-form-name"},a.a.createElement(ut.a.Label,null,a.a.createElement("strong",null,n)),a.a.createElement(oe.a,Object.assign({},r,t)))},Ur=function(e){var t=e.onFormSubmit,n=e.validate;return a.a.createElement(ut.a,{noValidate:!0,id:"delete-room-form",onSubmit:t},a.a.createElement(pt.a,{component:Fr,name:"roomName",label:"Room Name:",placeholder:"Enter Room name here",validate:n,required:!0}))},kr=function(e){function t(e){var n,r;return Object(P.a)(this,t),(n=Object(C.a)(this,Object(N.a)(t).call(this,e))).deleteRoomFieldValidate=(r=n.props.room,function(e){return r&&e===r.name?void 0:"Room name not equal"}),n}return Object(w.a)(t,e),Object(I.a)(t,[{key:"render",value:function(){var e=this.props,t=e.room,n=e.onFormSubmit,r=e.deleteRoomForm,o=e.handleSubmit;return a.a.createElement(Ur,{room:t,deleteRoomFormData:r,onFormSubmit:o(n),validate:this.deleteRoomFieldValidate})}}]),t}(a.a.Component),_r=Object(ft.a)({form:"delete-room-form"})(kr),Ar=function(e){var t=e.deleteRoomProgress,n=e.deleteRoomFormData,r=e.modalProps,o=e.isModalVisible,i=e.hideModal,s=e.onFormSubmit;return a.a.createElement(fr,{header:"Delete Room",actions:function(){var e=t===Re||t===je?"Go Back":"Cancel";return a.a.createElement(a.a.Fragment,null,a.a.createElement(A.a,{variant:"outline-secondary",onClick:i},e),function(){var e=n?n.syncErrors:null,r=e&&e.roomName;return a.a.createElement(an,{progress:t,propsProgressInitial:{type:"submit",form:"delete-room-form",variant:"danger",disabled:r,className:"cursor-".concat(r?"not-allowed":"pointer")}})}())}(),content:function(){var e=r.room,t=e?e.name:"<unknown>";return a.a.createElement(be.a,null,a.a.createElement(ve.a,{sm:12},a.a.createElement(_r,{onFormSubmit:s,room:e})),a.a.createElement(ve.a,null,a.a.createElement("p",{className:"word-wrap-break-word"},"To delete the room ",a.a.createElement("strong",null,t)," type in the name of the room above")))}(),visible:o,hideModal:i})},Mr=function(e){function t(){var e,n;Object(P.a)(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(n=Object(C.a)(this,(e=Object(N.a)(t)).call.apply(e,[this].concat(a)))).onDeleteRoomFormSubmit=function(){var e=n.props,t=e.onDeleteRoomPending,r=e.onDeleteRoomSuccess,a=e.onDeleteRoomFail,o=e.deleteRoom,i=e.modalProps.room;t(),o(i.roomId,r,a)},n}return Object(w.a)(t,e),Object(I.a)(t,[{key:"render",value:function(){var e=this.props,t=e.deleteRoomForm,n=e.deleteRoomProgress,r=e.modalProps,o=e.isModalVisible,i=e.hideModal;return a.a.createElement(Ar,{deleteRoomFormData:t,deleteRoomProgress:n,modalProps:r,isModalVisible:o,hideModal:i,onFormSubmit:this.onDeleteRoomFormSubmit})}}]),t}(a.a.Component),Tr=Object(c.b)((function(e){var t=e.modal;return{isModalVisible:t.isModalOpen&&"DeleteRoom"===t.modalName,modalProps:t.modalProps,deleteRoomForm:e.form["delete-room-form"]}}),{hideModal:T,deleteRoom:function(e,t,n){return function(r){return Be.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:Xe(e).then((function(n){t(),r({type:"DELETE_ROOM",payload:e})})).catch(n);case 1:case"end":return a.stop()}}))}}})(Mr),Lr=function(e){function t(){var e,n;Object(P.a)(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(n=Object(C.a)(this,(e=Object(N.a)(t)).call.apply(e,[this].concat(a)))).state={deleteRoomProgress:"prog_init"},n.onDeleteRoomPending=function(){n.setState({deleteRoomProgress:"prog_pending"})},n.onDeleteRoomSuccess=function(){n.setState({deleteRoomProgress:Re})},n.onDeleteRoomFail=function(){n.setState({deleteRoomProgress:je})},n}return Object(w.a)(t,e),Object(I.a)(t,[{key:"render",value:function(){return a.a.createElement(Tr,Object.assign({onDeleteRoomPending:this.onDeleteRoomPending,onDeleteRoomSuccess:this.onDeleteRoomSuccess,onDeleteRoomFail:this.onDeleteRoomFail},this.state))}}]),t}(a.a.Component),xr=function(e){var t=e.room,n=e.isModalVisible,r=e.hideModal,o=e.onLeaveRoomButtonClick,i=e.leaveRoomProgress;return a.a.createElement(fr,{header:"Leave Room",actions:function(){var e=i===Re||i===je?"Go Back":"Cancel";return a.a.createElement(a.a.Fragment,null,a.a.createElement(A.a,{variant:"outline-secondary",onClick:r},e),a.a.createElement(sn,{progress:i,propsProgressInitial:{variant:"danger",onClick:o}}))}(),content:function(){var e=a.a.createElement("strong",null,t?t.name:"<unknown>");return a.a.createElement("p",{className:"word-wrap-break-word"},"Are you sure you want to leave the room ",e,"?")}(),visible:n,hideModal:r})},Dr=Object(c.b)((function(e){var t=e.modal;return{isModalVisible:t.isModalOpen&&"LeaveRoom"===t.modalName,modalProps:t.modalProps}}),{hideModal:T,leaveRoom:function(e,t,n){return function(r,a){if(!e)return n(new Error({response:"Not a room member"}));var o,i,s,c,l=a().user.user._id,m=function(e,t){for(var n=0;n<e.members.length;n++){var r=e.members[n];if(r&&r.user&&r.user._id===t)return r}}(e,l);if(!m)return n(new Error({response:"Not a room member"}));(o=e.roomId,i=m._id,He.delete("/api/rooms/".concat(o,"/members/").concat(i)).then(s,c)).then((function(n){r({type:"LEAVE_ROOM",payload:{roomId:e.roomId,updatedMembers:n.data.members}}),t(n)})).catch(n)}}})((function(e){var t=e.modalProps.room,n=Object(_.a)(e,["modalProps"]),r=n.isModalVisible,o=n.hideModal,i=n.leaveRoomProgress;return a.a.createElement(xr,{room:t,hideModal:o,isModalVisible:r,leaveRoomProgress:i,onLeaveRoomButtonClick:function(){var e=n.leaveRoom,r=n.onLeaveRoomPending,a=n.onLeaveRoomSuccess,o=n.onLeaveRoomFail;r(),e(t,a,o)}})})),Jr=function(e){function t(){var e,n;Object(P.a)(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(n=Object(C.a)(this,(e=Object(N.a)(t)).call.apply(e,[this].concat(a)))).state={leaveRoomProgress:"prog_init"},n.onLeaveRoomPending=function(){n.setState({leaveRoomProgress:"prog_pending"})},n.onLeaveRoomSuccess=function(){n.setState({leaveRoomProgress:Re})},n.onLeaveRoomFail=function(){n.setState({leaveRoomProgress:je})},n}return Object(w.a)(t,e),Object(I.a)(t,[{key:"render",value:function(){return a.a.createElement(Dr,Object.assign({onLeaveRoomPending:this.onLeaveRoomPending,onLeaveRoomSuccess:this.onLeaveRoomSuccess,onLeaveRoomFail:this.onLeaveRoomFail},this.state))}}]),t}(a.a.Component),Br=function(e){var t=e.input,n=e.label,r=Object(_.a)(e,["input","label"]);return a.a.createElement(dt.a,{controlId:"invite-user-form-username"},a.a.createElement(ut.a.Label,null,a.a.createElement("strong",null,n)),a.a.createElement(oe.a,Object.assign({},r,t)))},Vr=function(e){var t=e.onFormSubmit;return a.a.createElement(ut.a,{id:"invite-user-form",onSubmit:t},a.a.createElement(pt.a,{component:Br,name:"inviteeUsername",label:"Invitee Username:",placeholder:"Enter username of user to be invited",required:!0}))},qr=Object(ft.a)({form:"invite-user-form"})((function(e){var t=e.onFormSubmit,n=e.handleSubmit;return a.a.createElement(Vr,{onFormSubmit:n(t)})})),Hr=(n(407),function(e){var t=e.user,n=e.onItemClick;return a.a.createElement(Ce.a.Item,{className:"username-list-item p-0"},a.a.createElement(A.a,{variant:"secondary",className:"w-100 border-0",onClick:n},t.username))}),Gr=function(e){var t=e.queryUsername,n=function(){var e=W()(t);return{text:e?"Type a username above...":'No user matching "'.concat(t,'"'),icon:e?K.e:K.b}}(),r=n.text,o=n.icon;return a.a.createElement("div",{className:"username-list-container subtitle d-flex flex-column align-items-center justify-content-center"},a.a.createElement(X.a,{icon:o,size:"lg"}),a.a.createElement("p",{className:"max-height-100 min-width-0"},r))},Qr=function(e){var t=e.userList,n=e.queryUsername,r=e.onItemClick;return W()(t)?a.a.createElement(Gr,{queryUsername:n}):a.a.createElement("div",{className:"username-list-container word-wrap-break-word d-flex flex-column"},a.a.createElement("p",{className:"subtitle"},"Found ",t.length," ","user",t.length>1?"s ":" ",'matching "',n,'"'),a.a.createElement(Ce.a,{className:"pre-scrollable",variant:"flush"},t.map((function(e){return a.a.createElement(Hr,{key:e._id,user:e,onItemClick:function(){return r(e.username)}})}))))},zr=function(e){var t=e.isModalVisible,n=e.hideModal,r=e.onFormSubmit,o=e.matchingUsers,i=e.queryUsername,s=e.selectUsername,c=e.inviteUserProgress;return a.a.createElement(fr,{header:"Invite User",actions:a.a.createElement(a.a.Fragment,null,a.a.createElement(A.a,{onClick:n,variant:"outline-secondary"},"Cancel"),a.a.createElement(ln,{progress:c,propsProgressInitial:{type:"submit",form:"invite-user-form"}})),content:a.a.createElement(Q.a,null,a.a.createElement(qr,{onFormSubmit:r}),a.a.createElement("hr",null),a.a.createElement(Qr,{userList:o,queryUsername:i,onItemClick:function(e){return s(e)}})),visible:t,hideModal:n})},Yr=function(e){function t(){var e,n;Object(P.a)(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(n=Object(C.a)(this,(e=Object(N.a)(t)).call.apply(e,[this].concat(a)))).state={inviteUserProgress:"prog_init",matchingUsers:[]},n.onInviteUserPending=function(){n.setState({inviteUserProgress:"prog_pending"})},n.onInviteUserSuccess=function(e){var t=e.data;console.log("user: ",t),n.setState({inviteUserProgress:Re})},n.onInviteUserFailure=function(e){var t=e.response;console.log("fail user: ",t),n.setState({inviteUserProgress:je})},n.onInviteUserFormSubmit=function(e){var t=e.inviteeUsername;n.onInviteUserPending(),ze(t).then((function(e){var t=e.data,r=n.props.modalProps.room;Ze(t._id,r.roomId,n.onInviteUserSuccess,n.onInviteUserFailure)})).catch(n.onInviteUserFailure)},n.getUsernameFromInviteUserForm=function(e){var t=e&&e.values,n=t&&t.inviteeUsername;return n?n.trim():n},n}return Object(w.a)(t,e),Object(I.a)(t,[{key:"componentDidUpdate",value:function(e){var t,n;return Be.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:if(t=this.getUsernameFromInviteUserForm(this.props.inviteUserForm),this.getUsernameFromInviteUserForm(e.inviteUserForm)!==t){r.next=4;break}return r.abrupt("return");case 4:return W()(t)&&this.setState({matchingUsers:[]}),r.prev=5,r.next=8,Be.a.awrap((a=t,o=void 0,i=void 0,He.get("/api/search?category=user&query=".concat(a)).then(o,i)));case 8:n=r.sent,r.next=14;break;case 11:r.prev=11,r.t0=r.catch(5),n={data:{payload:[]}};case 14:return r.prev=14,this.setState({matchingUsers:n.data.payload}),r.finish(14);case 17:case"end":return r.stop()}var a,o,i}),null,this,[[5,11,14,17]])}},{key:"render",value:function(){var e=this.getUsernameFromInviteUserForm(this.props.inviteUserForm);return a.a.createElement(zr,Object.assign({onFormSubmit:this.onInviteUserFormSubmit,queryUsername:e},this.props,this.state))}}]),t}(a.a.Component),Wr=Object(c.b)((function(e){var t=e.modal,n=t.isModalOpen,r=t.modalName;return{isModalVisible:n&&"InviteUser"===r,modalProps:t.modalProps,inviteUserForm:e.form["invite-user-form"]}}),{hideModal:T,selectUsername:function(e){return Object(Mt.a)("invite-user-form","inviteeUsername",e)}})((function(e){return a.a.createElement(Yr,e)})),Xr=function(e){var t=e.acceptInvitationProgress,n=e.modalProps.invitation,r=e.isModalVisible,o=e.hideModal,i=e.isTaskCompleted,s=e.onIgnoreButtonClick,c=e.onAcceptButtonClick;return a.a.createElement(fr,{header:"Review Room Invitation",content:function(){var e=n.inviter,t=n.room,r=e&&e.username,o=t&&t.name;return a.a.createElement("p",{className:"mb-0"},a.a.createElement("em",null,r)," ","invited you to join the room"," ",a.a.createElement("em",null,o))}(),actions:a.a.createElement(a.a.Fragment,null,a.a.createElement(A.a,{variant:"outline-secondary",onClick:i?o:s},i?"Go Back":"Ignore"),a.a.createElement(mn,{progress:t,propsProgressInitial:{onClick:c}})),visible:r,hideModal:o})},Kr=function(e){function t(){var e,n;Object(P.a)(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(n=Object(C.a)(this,(e=Object(N.a)(t)).call.apply(e,[this].concat(a)))).state={acceptInvitationProgress:"prog_init"},n.onAcceptInvitationPending=function(){n.setState({acceptInvitationProgress:"prog_pending"})},n.onAcceptInvitationSuccess=function(){n.setState({acceptInvitationProgress:Re});var e=n.props;(0,e.markNotificationAsReviewed)(e.modalProps.notificationId)},n.onAcceptInvitationFail=function(){n.setState({acceptInvitationProgress:je})},n.onAcceptInvitationButtonClick=function(){n.onAcceptInvitationPending();var e=n.props;(0,e.acceptRoomInvitation)(e.modalProps.invitation._id,n.onAcceptInvitationSuccess,n.onAcceptInvitationFail)},n.onIgnoreInvitationButtonClick=function(){var e=n.props,t=e.hideModal;(0,e.markNotificationAsReviewed)(e.modalProps.notificationId),t()},n}return Object(w.a)(t,e),Object(I.a)(t,[{key:"render",value:function(){var e=[Re,je].includes(this.state.acceptInvitationProgress);return a.a.createElement(Xr,Object.assign({onIgnoreButtonClick:this.onIgnoreInvitationButtonClick,onAcceptButtonClick:this.onAcceptInvitationButtonClick,isTaskCompleted:e},this.props,this.state))}}]),t}(a.a.Component),Zr=Object(c.b)((function(e){var t=e.modal;return{isModalVisible:t.isModalOpen&&"ReviewRoomInvitation"===t.modalName,modalProps:t.modalProps}}),{hideModal:T,markNotificationAsReviewed:function(e){return function(t){return Be.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:console.log({notificationId:e}),Ke(e,(function(e){t({type:"UPDATE_NOTIFICATION",payload:e.data})}));case 3:case"end":return n.stop()}}))}},acceptRoomInvitation:function(e,t,n){return function(r){return Be.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:$e(e,(function(e){r({type:"UPDATE_ROOM",payload:e.data}),t(e)}),n);case 2:case"end":return a.stop()}}))}}})((function(e){return a.a.createElement(Kr,e)})),$r=Object(c.b)((function(e){return{modal:e.modal}}))((function(e){return e.modal.isModalOpen?function(e){switch(e){case"CreateRoom":return a.a.createElement(Or,null);case"JoinRoom":return a.a.createElement(wr,null);case"DeleteRoom":return a.a.createElement(Lr,null);case"LeaveRoom":return a.a.createElement(Jr,null);case"InviteUser":return a.a.createElement(Wr,null);case"ReviewRoomInvitation":return a.a.createElement(Zr,null);default:return null}}(e.modal.modalName):null})),ea=n(417),ta=n(208),na=n(207),ra=(n(408),function(e){var t=e.header,n=e.body,r=e.onClose,o=e.show,i=Object(_.a)(e,["header","body","onClose","show"]),s=r||function(){};return a.a.createElement(ea.a,Object.assign({show:o,autohide:!0,delay:8e3,onClose:s},i),a.a.createElement(ta.a,{closeButton:!1,className:"toast-header-custom"},a.a.createElement("div",{className:"d-flex justify-content-between w-100 p-0 m-0"},a.a.createElement("div",null,t),a.a.createElement("div",{className:"m-0 p-0 cursor-pointer"},a.a.createElement(X.a,{icon:K.p,onClick:s})))),a.a.createElement(na.a,null,n))}),aa=function(e){var t=e.isToastVisible,n=e.onToastClose;return a.a.createElement(ra,{header:"New Notification",body:"You have a new notification",show:t,onClose:n})},oa=Object(c.b)((function(e){return{isToastVisible:e.toast.activeToasts.includes("NewNotification")}}),{hideToast:function(e){return{type:"HIDE_TOAST",payload:{name:e}}}})((function(e){return a.a.createElement(aa,Object.assign({},e,{onToastClose:function(){e.hideToast("NewNotification")}}))})),ia=(n(409),Object(c.b)((function(e){return{activeToasts:e.toast.activeToasts}}))((function(e){var t=e.activeToasts;return a.a.createElement("div",{className:"toast-container"},t.map((function(e){return function(e){switch(e){case"NewNotification":return a.a.createElement(oa,null);default:return null}}(e)})))}))),sa=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||s.d,ca=Object(s.e)(S,sa(Object(s.a)(l.a)));i.a.render(a.a.createElement(c.a,{store:ca},a.a.createElement(dr,null),a.a.createElement($r,null),a.a.createElement(ia,null)),document.querySelector("#root"))}},[[235,1,2]]]);
//# sourceMappingURL=main.876c6c77.chunk.js.map