(this.webpackJsonpchatrooms=this.webpackJsonpchatrooms||[]).push([[0],{233:function(e,t,r){e.exports=r(403)},302:function(e,t,r){},305:function(e,t,r){},306:function(e,t,r){},324:function(e,t,r){},364:function(e,t,r){},392:function(e,t){},395:function(e,t,r){},396:function(e,t,r){},397:function(e,t,r){},398:function(e,t,r){},399:function(e,t,r){},400:function(e,t,r){},401:function(e,t,r){},402:function(e,t,r){},403:function(e,t,r){"use strict";r.r(t);var n=r(0),o=r.n(n),a=r(23),s=r.n(a),i=r(22),c=r(10),l=r(188),m=r(186),u={connected:!1},d=r(61),p=r(7),f=r(133),g=r.n(f),b=function(e,t){var r=t.roomId,n=t.updatedMembers;return Object(p.a)({},e,Object(d.a)({},r,Object(p.a)({},e[r],{members:n})))},h=r(8),E={length:0,data:{}},v={isLoggedIn:!1,user:{}},O={isModalOpen:!1,modalName:null,modalProps:null},y={sortBy:"name-asc",itemsPerPage:10,currentPageNumber:1,searchQuery:null},R=Object(i.c)({user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGIN":return{isLoggedIn:!0,user:t.payload.user};case"LOGOUT":return v;case"REGISTER":return{isLoggedIn:!1,user:t.payload};case"UPDATE_USER":return Object(p.a)({},e,{},t.payload);default:return e}},serverConnection:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u,t=arguments.length>1?arguments[1]:void 0;return"CONNECT_TO_SERVER"===t.type?{connected:t.payload.connected}:e},rooms:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"FETCH_PUBLIC_ROOMS":return Object(p.a)({},e,{},g.a.mapKeys(t.payload,"roomId"));case"FETCH_ROOM":var r=t.payload;return Object(p.a)({},e,Object(d.a)({},r.roomId,r));case"DELETE_ROOM":return g.a.omit(e,t.payload);case"LEAVE_ROOM":case"JOIN_ROOM":return b(e,t.payload);default:return e}},roomListDisplaySettings:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:y,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_ROOM_LIST_SORT_TECHNIQUE":return Object(p.a)({},e,{sortBy:t.payload});case"SET_ROOM_LIST_ITEMS_PER_PAGE":return Object(p.a)({},e,{itemsPerPage:t.payload});case"SET_ROOM_LIST_CURRENT_PAGE":return Object(p.a)({},e,{currentPageNumber:t.payload});case"SET_ROOM_LIST_SEARCH_QUERY":return Object(p.a)({},e,{searchQuery:t.payload});default:return e}},notifications:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:E,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"CREATE_NOTIFICATION":var r=t.payload,n=r.id,o=Object(h.a)(r,["id"]);return console.log("id: "+n+"\nmetadata:"),console.log(o),Object(p.a)({},e,{length:e.length+1,data:Object(p.a)({},e.data,Object(d.a)({},n,o))});default:return e}},form:m.a,modal:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SHOW_MODAL":return Object(p.a)({isModalOpen:!0},t.payload);case"HIDE_MODAL":return O;default:return e}}}),j=r(11),S=r(12),P=r(14),C=r(13),F=r(15),w=r(27),I=r(56),N=r(96),_=function(e){var t=e.showModal,r=e.modalName,n=e.modalProps,a=e.component,s=e.children,i=Object(h.a)(e,["showModal","modalName","modalProps","component","children"]),c=a;return o.a.createElement(c,Object.assign({onClick:function(){return t(r,n)}},i),s)},M=function(e){return{type:"HIDE_MODAL"}},k=Object(c.b)(null,{showModal:function(e,t){return{type:"SHOW_MODAL",payload:{modalName:e,modalProps:t}}}})((function(e){return o.a.createElement(_,e)})),L=k,A=function(e){var t=e.to,r=e.shouldUseReplace,n=e.component,a=e.children,s=Object(h.a)(e,["to","shouldUseReplace","component","children"]),i=n,c=Object(I.g)();return o.a.createElement(i,Object.assign({onClick:function(){return r?c.replace(t):c.push(t)}},s),a)},U=function(e){var t=e.component,r=e.children,n=Object(h.a)(e,["component","children"]);return o.a.createElement(L,Object.assign({modalName:"CreateRoom",component:t||N.a},n),r)},x=function(e){var t=e.component,r=e.children,n=Object(h.a)(e,["component","children"]);return o.a.createElement(L,Object.assign({modalName:"JoinRoom",component:t||N.a},n),r)},T=function(e){var t=e.component,r=e.children,n=e.room,a=Object(h.a)(e,["component","children","room"]);return o.a.createElement(L,Object.assign({modalName:"DeleteRoom",modalProps:{room:n},component:t||N.a,variant:"danger"},a),r)},D=(r(302),function(){return o.a.createElement("div",{className:"landing-page compensate-header"},o.a.createElement("div",{className:"inner-wrapper"},o.a.createElement("p",null,"Welcome to ChatRooms!"),o.a.createElement("div",{className:"buttons-container"},o.a.createElement(U,null,"Create Room"),o.a.createElement(x,{variant:"outline-primary"},"Join Room By Id"))))}),J=D,B=r(410),V=r(202),G=r(409),q=r(21),H=r(20),Q=r(136),z=function(e){var t=!e.dismissAction;return o.a.createElement(Q.a,{show:e.show,variant:e.variant,onClose:e.onDismiss,dismissible:t},o.a.createElement(Q.a.Heading,null,e.heading),o.a.createElement("p",null,e.body),o.a.createElement("div",{className:"d-flex justify-content-end"},e.dismissAction&&e.dismissAction()))},Y=r(108),X=r(111),W=function(e){return o.a.createElement(Y.a,{trigger:"click",placement:"bottom",rootClose:!0,overlay:o.a.createElement(X.a,null,o.a.createElement(X.a.Title,{as:"h2"},e.title),o.a.createElement(X.a.Content,null,e.menu))},e.triggerComponent)},K=r(194),Z=function(e){var t=e.triggerComponent,r=e.label,n=e.id,a=Object(h.a)(e,["triggerComponent","label","id"]);return o.a.createElement(Y.a,Object.assign({trigger:"hover",placement:"bottom",rootClose:!0,overlay:o.a.createElement(K.a,{id:n},r)},a),t)},$=r(196),ee=r(195),te=r.n(ee),re=(r(305),function(e){function t(){return Object(j.a)(this,t),Object(P.a)(this,Object(C.a)(t).apply(this,arguments))}return Object(F.a)(t,e),Object(S.a)(t,[{key:"componentDidMount",value:function(){te()(this.textareaRef)}},{key:"render",value:function(){var e=this;return o.a.createElement($.a,Object.assign({},this.props,this.props.input,{as:"textarea",rows:"1",className:"text-input-wrap",ref:function(t){return e.textareaRef=t}}))}}]),t}(o.a.Component)),ne=re,oe=r(207),ae=r(197),se=r(405),ie=function(e){var t=e.formProps,r=e.error,a=Object(n.useState)(!1),s=Object(oe.a)(a,2),i=s[0],c=s[1];return o.a.createElement(o.a.Fragment,null,o.a.createElement(ae.a,null,t.label),o.a.createElement(se.a,null,o.a.createElement($.a,Object.assign({},t,t.input,{type:i?"text":"password"})),o.a.createElement(se.a.Append,{onClick:function(){c(!i)},style:{cursor:"pointer"}},o.a.createElement(se.a.Text,null,o.a.createElement(q.a,{icon:i?H.c:H.d})))),o.a.createElement($.a,Object.assign({},t,t.input,{style:{display:"none"}})),o.a.createElement($.a.Feedback,{type:"invalid"},r))},ce=function(e){var t=e.label,r=Object(h.a)(e,["label"]);return o.a.createElement(N.a,r,t||"Initial")},le=r(407),me=r(406),ue=r(198),de=function(e){var t=e.icon,r=e.iconPos,n=e.children,a=(e.childrenProps,Object(h.a)(e,["icon","iconPos","children","childrenProps"])),s=0===r;return o.a.createElement(N.a,a,o.a.createElement(me.a,null,s?o.a.createElement(ue.a,null,t):null,o.a.createElement(ue.a,{className:s?"pl-0":"pr-0",style:{whiteSpace:"nowrap"}},n),1===r?o.a.createElement(ue.a,null,t):null))},pe=function(e){var t=e.icon,r=e.iconPos,n=e.label,a=Object(h.a)(e,["icon","iconPos","label"]);return o.a.createElement(de,Object.assign({icon:t||o.a.createElement(le.a,{animation:"border",size:"sm"}),iconPos:r||0,style:{cursor:"not-allowed"},variant:"info",disabled:!0},a),n||"Pending")},fe=function(e){var t=e.icon,r=e.iconPos,n=e.label,a=Object(h.a)(e,["icon","iconPos","label"]);return o.a.createElement(de,Object.assign({icon:t||o.a.createElement(q.a,{icon:H.b}),iconPos:r||0,style:{cursor:"not-allowed"},variant:"success",disabled:!0},a),n||"Initial")},ge=function(e){var t=e.icon,r=e.iconPos,n=e.label,a=Object(h.a)(e,["icon","iconPos","label"]);return o.a.createElement(de,Object.assign({icon:t||o.a.createElement(q.a,{icon:H.l}),iconPos:r||0,style:{cursor:"not-allowed"},variant:"danger",disabled:!0},a),n||"Initial")},be=function(e){var t=e.progress,r=e.propsProgressInitial,n=e.propsProgressPending,a=e.propsProgressSuccess,s=e.propsProgressFailure,i=Object(h.a)(e,["progress","propsProgressInitial","propsProgressPending","propsProgressSuccess","propsProgressFailure"]);switch(t){case"prog_init":return o.a.createElement(ce,Object.assign({},r,i));case"prog_pending":return o.a.createElement(pe,Object.assign({},n,i));case"prog_success":return o.a.createElement(fe,Object.assign({},a,i));case"prog_fail":return o.a.createElement(ge,Object.assign({},s,i));default:return o.a.createElement(ce,Object.assign({label:"Click Here"},i))}},he=be,Ee=function(e,t){e.navigate;var r=Object(h.a)(e,["navigate"]);return o.a.createElement(t,r)},ve=r(199),Oe=o.a.forwardRef((function(e,t){var r=e.children,n=e.className,a=e.style;return o.a.createElement("div",{ref:t,className:n,style:a},r)})),ye=function(e){return console.log("item. title: "+e.notification.title),o.a.createElement(o.a.Fragment,null,o.a.createElement(ve.a,{as:Oe},e.notification.content),o.a.createElement("hr",null))},Re=ye,je=function(e){var t=e.notifications;return o.a.createElement("div",null,0===t.length?"You don't have any notifications":Object.keys(t.data).map((function(e){var r=t.data[e];return o.a.createElement(Re,{key:e,notification:r})})))},Se=je,Pe=(r(306),function(e){var t=e.notifications;return o.a.createElement(W,{title:"Notifications",menu:o.a.createElement(Se,{notifications:t}),triggerComponent:function(){var e=t.length>0?"visible":"hidden";return o.a.createElement(q.a,{icon:H.a,size:"lg"},o.a.createElement(q.a,{icon:H.e,className:"notification-badge ".concat(e)}))}()})}),Ce=Object(c.b)((function(e){return{notifications:e.notifications}}))((function(e){var t=e.notifications;return o.a.createElement(Pe,{notifications:t})})),Fe=Ce,we=function(e){var t=e.username,r=e.logoutUser,n=o.a.createElement(q.a,{icon:H.m,size:"lg"}),a=o.a.createElement("span",null,"Signed in as ",o.a.createElement("strong",null,t));return o.a.createElement(W,{title:a,menu:o.a.createElement("div",{className:"d-flex flex-column align-items-center"},o.a.createElement(N.a,{variant:"outline-secondary",onClick:r},"Sign Out")),triggerComponent:n})},Ie=r(24),Ne=r.n(Ie),_e=r(200),Me=r.n(_e),ke=Me.a.create({withCredentials:!0}),Le=function(e,t,r,n,o){return ke.post("/api/register",{username:e,password:t,confirmPassword:r}).then(n,o)},Ae=function(e,t,r,n){return ke.post("/api/login",{username:e,password:t}).then(r,n)},Ue=function(e,t,r){return ke.get("/api/rooms/".concat(e)).then(t,r)},xe=function(e,t,r,n){return ke.post("/api/rooms",{roomName:e,roomType:t}).then(r,n)},Te=function(e,t,r){return ke.delete("/api/rooms/".concat(e)).then(t,r)},De=function(e,t){var r,n;r=function(r){var n=e.data,o=r.data.isLoggedIn;t(function(e,t){return{type:"UPDATE_USER",payload:{isLoggedIn:e,user:t}}}(o,n))},n=function(e){var t=e.response;return console.log("Check user status fail: ",t)},ke.get("/api/user/status/login").then(r,n)},Je=Object(c.b)((function(e){var t=e.user;return{username:t.user&&t.user.username}}),{logoutUser:function(){return function(e){return Ne.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:r=function(){return e({type:"LOGOUT"})},n=function(e){var t=e.response;return console.log("Logout Failed: ",t)},ke.post("/api/logout").then(r,n);case 1:case"end":return t.stop()}var r,n}))}}})((function(e){var t=e.username,r=e.logoutUser;return o.a.createElement(we,{username:t,logoutUser:r})})),Be=Je,Ve=(r(324),o.a.createElement(w.b,{to:"/register",component:function(e){return Ee(e,N.a)}},"Register")),Ge=o.a.createElement(w.b,{to:"/login",component:function(e){return Ee(e,N.a)},variant:"outline-primary"},"Login"),qe=function(e){var t=e.isUserRegistered,r=e.isUserLoggedIn,n=function(e){return o.a.createElement(B.a.Item,{className:"mx-3 cursor-pointer"},e)};return o.a.createElement(V.a,{className:"header-navbar-container",fluid:!0},o.a.createElement(G.a,{expand:"large",sticky:"top"},o.a.createElement(G.a.Brand,null,o.a.createElement(w.b,{to:"/",className:"brand"}," ChatRooms ")),o.a.createElement(B.a,{className:"flex-row"},o.a.createElement(V.a,null,o.a.createElement(B.a.Item,{className:"mx-3"},o.a.createElement(w.b,{to:"/rooms",component:function(e){return Ee(e,B.a.Link)},className:"header-text"},"Rooms")),o.a.createElement(B.a.Item,{className:"mx-3 cursor-pointer"},o.a.createElement(Fe,null)),r?null:n(Ge),t?null:n(Ve),r&&t?n(o.a.createElement(Be,null)):null))))},He=Object(c.b)((function(e){var t=e.user;return{isUserLoggedIn:t.isLoggedIn,isUserRegistered:t.user&&t.user.isRegistered}}))((function(e){var t=e.isUserRegistered,r=e.isUserLoggedIn;return o.a.createElement(qe,{isUserRegistered:t,isUserLoggedIn:r})})),Qe=He,ze=function(e){return o.a.createElement("div",null,o.a.createElement(Qe,null),o.a.createElement("div",{className:"centered-content"},e))},Ye=function(e){return ze(o.a.createElement(J,e))},Xe=Ye,We=r(411),Ke=r(203),Ze=r(184),$e=r(185),et=function(e){var t=e.meta.error,r=function(e){var t=e.meta,r=t.touched,n=t.error,o=t.pristine,a=r&&n;return Object(p.a)({},e,{},e.input,{isInvalid:a,isValid:!o&&!a})}(e);return"password"===e.type?o.a.createElement(ie,{formProps:r,error:t}):o.a.createElement(o.a.Fragment,null,o.a.createElement(We.a.Label,null,e.label),o.a.createElement($.a,r),o.a.createElement($.a.Feedback,{type:"invalid"},t))},tt=Object($e.a)({form:"loginForm",validate:function(e){var t={};return e.username||(t.username="Username is required"),e.password||(t.password="Password is required"),t}})((function(e){return o.a.createElement(We.a,{onSubmit:e.handleSubmit(e.onFormSubmit)},o.a.createElement(Ke.a,{controlId:"formUsernameGroup"},o.a.createElement(Ze.a,{component:et,name:"username",type:"text",label:"Enter Username",placeholder:"Example: mitsy_the_cat"})),o.a.createElement(Ke.a,{controlId:"formPasswordGroup"},o.a.createElement(Ze.a,{component:et,name:"password",type:"password",label:"Enter Password",placeholder:"Password"})),o.a.createElement(N.a,{type:"submit"},"Login"))})),rt=(r(364),function(e){return e.isUserLoggedIn?o.a.createElement(I.a,{to:"/"}):function(e){var t=e.shouldShowErrorAlert,r=e.errorReason,n=e.onErrorAlertDismissed,a=e.onFormSubmit;return o.a.createElement(V.a,{className:"compensate-header"},o.a.createElement("div",{className:"centered-content login-container"},!1,o.a.createElement(z,{variant:"danger",heading:"Login Unsuccessful",body:r,show:t,onDismiss:n}),o.a.createElement(tt,{onFormSubmit:a})))}(e)}),nt=function(e){function t(){var e,r;Object(j.a)(this,t);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(r=Object(P.a)(this,(e=Object(C.a)(t)).call.apply(e,[this].concat(o)))).onFormSubmit=function(e){r.props.loginUser(e.username,e.password,r.props.onLoginFailure)},r}return Object(F.a)(t,e),Object(S.a)(t,[{key:"render",value:function(){var e=this.props,t=e.shouldShowErrorAlert,r=e.errorReason,n=e.onErrorAlertDismissed,a=e.isUserLoggedIn;return o.a.createElement(rt,{isUserLoggedIn:a,errorReason:r,shouldShowErrorAlert:t,onErrorAlertDismissed:n,onFormSubmit:this.onFormSubmit})}}]),t}(o.a.Component),ot=Object(c.b)((function(e){return{isUserLoggedIn:e.user.isLoggedIn}}),{loginUser:function(e,t,r){return function(n){return Ne.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:Ae(e,t,(function(e){n({type:"LOGIN",payload:{user:e.data}})}),r);case 2:case"end":return o.stop()}}))}}})(nt),at=function(e){function t(){var e,r;Object(j.a)(this,t);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(r=Object(P.a)(this,(e=Object(C.a)(t)).call.apply(e,[this].concat(o)))).state={errorReason:null,shouldShowErrorAlert:!1},r.onLoginFailure=function(e){var t=e.response;r.setState({errorReason:t.data.reason,shouldShowErrorAlert:!0})},r.onErrorAlertDismissed=function(){r.setState({shouldShowErrorAlert:!1})},r}return Object(F.a)(t,e),Object(S.a)(t,[{key:"render",value:function(){return o.a.createElement(ot,Object.assign({onLoginFailure:this.onLoginFailure,onErrorAlertDismissed:this.onErrorAlertDismissed},this.state))}}]),t}(o.a.Component),st=at,it=st,ct=function(e){return ze(o.a.createElement(it,e))},lt=ct,mt=r(204),ut=r.n(mt),dt="event:room",pt="connect_to_room",ft="event:message",gt="send_message",bt="event:user",ht="check_username",Et=ut()("/",{autoConnect:!1}),vt=function(e){Et.connect(),Et.on("connect_error",e)},Ot=function(e){var t=e.meta.error,r=function(e){var t=e.meta,r=t.touched,n=t.error,o=t.pristine,a=t.asyncValidating,s=function(e){return"That username is already taken"===e}(n)||r&&n;return Object(p.a)({},e,{},e.input,{className:a?"input-loading":"",isInvalid:s,isValid:!a&&!o&&!s})}(e);return"password"===e.type?o.a.createElement(ie,{formProps:r,error:t}):o.a.createElement(o.a.Fragment,null,o.a.createElement(We.a.Label,null,e.label),o.a.createElement($.a,r),o.a.createElement($.a.Feedback,{type:"invalid"},t))},yt=function(e){var t=e.onFormSubmit,r=e.isRegisterButtonDisabled,n=r?"not-allowed":"cursor";return o.a.createElement(We.a,{noValidate:!0,id:"registration-form",onSubmit:t},o.a.createElement(Ke.a,{controlId:"formUsernameGroup"},o.a.createElement(Ze.a,{component:Ot,name:"username",type:"text",label:"Enter Username",placeholder:"Example: mitsy_the_cat"})),o.a.createElement(Ke.a,{controlId:"formPasswordGroup"},o.a.createElement(Ze.a,{component:Ot,name:"password",type:"password",label:"Enter Password",placeholder:"Password"})),o.a.createElement(Ke.a,{controlId:"formConfirmPasswordGroup"},o.a.createElement(Ze.a,{component:Ot,name:"confirmPassword",type:"password",label:"Confirm Password",placeholder:"Confirm Password"})),o.a.createElement(N.a,{type:"submit",form:"registration-form",className:"cursor-".concat(n),disabled:r},"Register"))},Rt=Object($e.a)({form:"registerForm",validate:function(e){var t=e.username,r=e.password,n=e.confirmPassword,o={};if(t||(o.username="Username cannot be empty"),r||(o.password="Password cannot be empty"),n){if(function(e,t){return e!==t}(r,n)){var a="Confirm Password and Password must match";o.confirmPassword=a,o.password=a}}else o.confirmPassword="Confirm Password cannot be empty";return o},asyncValidate:function(e,t){return new Promise((function(t,r){return n=e.username,o=function(e){200===e.status?r({username:"That username is already taken"}):t()},Et.emit(bt,ht,n,o);var n,o}))},asyncChangeFields:["username"]})((function(e){var t=e.handleSubmit,r=e.onFormSubmit,n=Object(h.a)(e,["handleSubmit","onFormSubmit"]),a=n.pristine,s=n.submitting,i=n.asyncValidating,c=n.invalid,l=a||s||i||c;return o.a.createElement(yt,{isRegisterButtonDisabled:l,onFormSubmit:t(r)})})),jt=Rt,St=function(e){var t=e.onFormSubmit,r=e.isUserLoggedIn,n=e.isUserRegistered;return r||n?function(){var e=o.a.createElement(I.a,{to:"/"}),t=o.a.createElement(I.a,{to:{pathname:"/login",state:{isRedirectFromSuccessfulRegister:!0}}});return r?e:n?r?e:t:void 0}():o.a.createElement("div",{className:"centered-content"},o.a.createElement(V.a,null,o.a.createElement(jt,{onFormSubmit:t})))},Pt=function(e){function t(){var e,r;Object(j.a)(this,t);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(r=Object(P.a)(this,(e=Object(C.a)(t)).call.apply(e,[this].concat(o)))).onRegistrationFailed=function(e){var t=e.response;console.log("Registration failed: ",t)},r.onFormSubmit=function(e){console.log("Registration Form Values: ",e),r.props.registerUser(e.username,e.password,e.confirmPassword,r.onRegistrationFailed)},r}return Object(F.a)(t,e),Object(S.a)(t,[{key:"render",value:function(){var e=this.props,t=e.isUserLoggedIn,r=e.isUserRegistered;return o.a.createElement(St,{isUserLoggedIn:t,isUserRegistered:r,onFormSubmit:this.onFormSubmit})}}]),t}(o.a.Component),Ct=Object(c.b)((function(e){return{isUserRegistered:e.user.user&&e.user.user.isRegistered,isUserLoggedIn:e.user.isLoggedIn}}),{registerUser:function(e,t,r,n){return function(o){return Ne.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:Le(e,t,r,(function(e){return o({type:"REGISTER",payload:e.data})}),n);case 1:case"end":return a.stop()}}))}}})(Pt),Ft=Ct,wt=function(e){return ze(o.a.createElement(Ft,e))},It=wt,Nt=r(30),_t=(r(395),function(e){return o.a.createElement(ne,e)}),Mt=function(e){var t=e.onFormSubmit,r=e.formId;return o.a.createElement(We.a,{onSubmit:t,id:r,className:"chat-message-form"},o.a.createElement(V.a,{className:"d-flex align-items-center",fluid:!0},o.a.createElement("div",{className:"textarea-flex-container"},o.a.createElement(We.a.Group,{controlId:"message",className:"textarea-wrapper"},o.a.createElement(Ze.a,{name:"message",placeholder:"Type a message...",type:"text",component:_t}))),o.a.createElement("div",{className:"send-btn-flex-container"},o.a.createElement(N.a,{type:"submit",form:r,variant:"outline-primary"},"Send"))))},kt="chat-message-form",Lt=Object($e.a)({form:kt,onSubmitSuccess:function(e,t){t(Object(Nt.a)(kt))}})((function(e){var t=e.handleSubmit,r=e.onFormSubmit;return o.a.createElement(Mt,{onFormSubmit:t(r),formId:kt})})),At=Lt,Ut=r(205),xt=(r(396),function(e){var t=e.message,r=e.align,n=e.color,a=e.isCurrentUserMessageAuthor;if(!t)return null;var s=a?"You":t.author&&t.author.username?t.author.username:"<unknown-user>",i=function(){var e="15px solid ".concat(n),t="left"===r?{borderRight:e}:{borderLeft:e};return o.a.createElement("p",{className:"msg-box-arrow ".concat(r),style:t})}();return o.a.createElement(Ut.a.Item,{key:t.id,style:{border:"none"}},o.a.createElement(V.a,{className:"message float-".concat(r),style:{backgroundColor:n}},"left"===r&&i,s&&o.a.createElement("p",null,o.a.createElement("strong",null,s)),o.a.createElement("p",null,t.data),"right"===r&&i))}),Tt=function(e){function t(){var e,r;Object(j.a)(this,t);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(r=Object(P.a)(this,(e=Object(C.a)(t)).call.apply(e,[this].concat(o)))).isCurrentUserMessageAuthor=function(){var e=r.props,t=e.message,n=e.userId;return t&&t.author&&t.author._id===n},r}return Object(F.a)(t,e),Object(S.a)(t,[{key:"render",value:function(){var e=this.props,t=e.message,r=e.color;if(!t)return null;var n=this.isCurrentUserMessageAuthor()?"right":"left";return o.a.createElement(xt,{message:t,align:n,color:r,isCurrentUserMessageAuthor:this.isCurrentUserMessageAuthor()})}}]),t}(o.a.Component),Dt=Object(c.b)((function(e){return{userId:e.user.user._id}}),null)(Tt),Jt=Dt,Bt=(r(397),function(e){var t=e.room,r=e.colorsAssignedToMessageAuthors;return o.a.createElement(Ut.a,{className:"chat-window pre-scrollable",variant:"flush"},t.messages.map((function(e){var n=e.author&&e.author._id;return o.a.createElement(Jt,{color:r[n],roomId:t.roomId,message:e,key:e&&e._id})})))}),Vt=["#fff07c","#80ff72","#7ee8fa","#eec0c6","#e58c8a"],Gt=function(e){return Vt.length===e.length},qt=function(e,t){return-1!==e.indexOf(t)},Ht=function(e){var t={},r=[];return e.forEach((function(e){if(!t[e]){var n=function(e){var t;do{var r=Math.floor(Math.random()*Vt.length);t=Vt[r]}while(qt(e,t)&&!Gt(e));return t}(r);t[e]=n,Gt(r)||r.push(n)}})),t},Qt=function(e){function t(){var e,r;Object(j.a)(this,t);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(r=Object(P.a)(this,(e=Object(C.a)(t)).call.apply(e,[this].concat(o)))).state={randomAuthorColors:[]},r}return Object(F.a)(t,e),Object(S.a)(t,[{key:"componentDidMount",value:function(){this.props.room&&this.setState({randomAuthorColors:this.assignRandomColorsToMessageAuthors()})}},{key:"assignRandomColorsToMessageAuthors",value:function(){var e=this.props.room.messages.map((function(e){return e.author&&e.author._id}));return Ht(e)}},{key:"render",value:function(){var e=this.props.room,t=this.state.randomAuthorColors;return e?o.a.createElement(Bt,{room:e,colorsAssignedToMessageAuthors:t}):null}}]),t}(o.a.Component),zt=Qt,Yt=zt,Xt=(r(398),function(e){var t=e.room,r=e.className;return o.a.createElement(V.a,{fluid:!0,className:"room-page-sub-header ".concat(r)},o.a.createElement("div",{className:"d-flex align-items-center h-100"},o.a.createElement("div",{className:"room-name-container text-overflow-ellipses"},t.name),o.a.createElement("div",{className:"room-actions-container"},o.a.createElement("div",{className:"d-flex justify-content-around"},[{tooltipLabel:"Leave Room",tooltipId:"tooltip-leave-room",Component:o.a.createElement(L,{component:q.a,icon:H.j,className:"cursor-pointer",modalName:"LeaveRoom",modalProps:{room:t}})},{tooltipLabel:"Invite User",tooltipId:"tooltip-invite-user",Component:o.a.createElement(q.a,{icon:H.f,className:"cursor-pointer"})},{tooltipLabel:"Close Room Window",tooltipId:"tooltip-close-room",Component:o.a.createElement(A,{component:q.a,icon:H.n,className:"cursor-pointer",to:"/rooms"})}].map((function(e){var t=e.tooltipId,r=e.tooltipLabel,n=e.Component;return o.a.createElement(Z,{triggerComponent:n,label:r,id:t,key:t})}))))))}),Wt=function(e,t,r){return function(n){(function(e,t,r){return ke.post("/api/rooms/".concat(e,"/members")).then(t,r)})(e).then((function(r){var o=r.data;n({type:"JOIN_ROOM",payload:{roomId:e,updatedMembers:o.members}}),t()})).catch(r)}},Kt=r(408),Zt=function(e){var t=e.progress,r=e.propsProgressInitial,n=e.propsProgressPending,a=e.propsProgressSuccess,s=e.propsProgressFailure,i=Object(h.a)(e,["progress","propsProgressInitial","propsProgressPending","propsProgressSuccess","propsProgressFailure"]);return o.a.createElement(he,Object.assign({progress:t},function(){var e=r&&Object(p.a)({},r),t=n&&Object(p.a)({},n),o=a&&Object(p.a)({},a),i=s&&Object(p.a)({},s);return{propsProgressInitial:Object(p.a)({label:"Create Room"},e),propsProgressPending:Object(p.a)({label:"Creating Room..."},t),propsProgressSuccess:Object(p.a)({label:"Room Created"},o),propsProgressFailure:Object(p.a)({label:"Error Creating Room"},i)}}(),i))},$t=function(e){var t=e.progress,r=e.propsProgressInitial,n=e.propsProgressPending,a=e.propsProgressSuccess,s=e.propsProgressFailure,i=Object(h.a)(e,["progress","propsProgressInitial","propsProgressPending","propsProgressSuccess","propsProgressFailure"]);return o.a.createElement(he,Object.assign({progress:t},function(){var e=r&&Object(p.a)({},r),t=n&&Object(p.a)({},n),o=a&&Object(p.a)({},a),i=s&&Object(p.a)({},s);return{propsProgressInitial:Object(p.a)({label:"Delete Room"},e),propsProgressPending:Object(p.a)({label:"Deleting Room..."},t),propsProgressSuccess:Object(p.a)({label:"Room Deleted"},o),propsProgressFailure:Object(p.a)({label:"Error Deleting Room"},i)}}(),i))},er=function(e){var t=e.progress,r=e.propsProgressInitial,n=e.propsProgressPending,a=e.propsProgressSuccess,s=e.propsProgressFailure,i=Object(h.a)(e,["progress","propsProgressInitial","propsProgressPending","propsProgressSuccess","propsProgressFailure"]);return o.a.createElement(he,Object.assign({progress:t},function(){var e=r&&Object(p.a)({},r),t=n&&Object(p.a)({},n),o=a&&Object(p.a)({},a),i=s&&Object(p.a)({},s);return{propsProgressInitial:Object(p.a)({label:"Join Room"},e),propsProgressPending:Object(p.a)({label:"Joining Room..."},t),propsProgressSuccess:Object(p.a)({label:"Room Joined"},o),propsProgressFailure:Object(p.a)({label:"Error Joining Room"},i)}}(),i))},tr=function(e){var t=e.progress,r=e.propsProgressInitial,n=e.propsProgressPending,a=e.propsProgressSuccess,s=e.propsProgressFailure,i=Object(h.a)(e,["progress","propsProgressInitial","propsProgressPending","propsProgressSuccess","propsProgressFailure"]);return o.a.createElement(he,Object.assign({progress:t},function(){var e=r&&Object(p.a)({},r),t=n&&Object(p.a)({},n),o=a&&Object(p.a)({},a),i=s&&Object(p.a)({},s);return{propsProgressInitial:Object(p.a)({label:"Leave Room"},e),propsProgressPending:Object(p.a)({label:"Leaving Room..."},t),propsProgressSuccess:Object(p.a)({label:"Room Left"},o),propsProgressFailure:Object(p.a)({label:"Error Leaving Room"},i)}}(),i))},rr=function(e){var t=e.progress,r=e.propsProgressInitial,n=e.propsProgressPending,a=e.propsProgressSuccess,s=e.propsProgressFailure,i=Object(h.a)(e,["progress","propsProgressInitial","propsProgressPending","propsProgressSuccess","propsProgressFailure"]);return o.a.createElement(he,Object.assign({progress:t},function(){var e=r&&Object(p.a)({},r),t=n&&Object(p.a)({},n),o=a&&Object(p.a)({},a),i=s&&Object(p.a)({},s);return{propsProgressInitial:Object(p.a)({label:"Send Join Request"},e),propsProgressPending:Object(p.a)({label:"Sending Request..."},t),propsProgressSuccess:Object(p.a)({label:"Room Join Request Sent"},o),propsProgressFailure:Object(p.a)({label:"Error Sending Request"},i)}}(),i))},nr=function(e){var t=e.room,r=e.joinRoomProgress,n=e.onJoinRoomButtonClick;if(console.log("room: ",t),!t)return null;var a="private"===t.type,s=a?"send a join request":"join the room";return o.a.createElement(V.a,{fluid:!0,className:"centered-content h-100"},o.a.createElement("div",{className:"d-flex flex-column justify-content-between align-items-center mx-auto"},o.a.createElement(q.a,{icon:H.h,size:"5x",color:"#b7b9ba",className:"mb-4"}),o.a.createElement("h4",null,"You are not a member of this room"),o.a.createElement("p",{className:" h-100 subtitle"},"To access, you must ",s),o.a.createElement(Kt.a,null,a?o.a.createElement("div",null,"Send a request"):function(e,t){return o.a.createElement(er,{progress:e,propsProgressInitial:{onClick:t}})}(r,n),o.a.createElement(w.b,{to:"/rooms",className:"btn btn-outline-secondary"},"Back to Rooms"))))},or=function(e){function t(){var e,r;Object(j.a)(this,t);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(r=Object(P.a)(this,(e=Object(C.a)(t)).call.apply(e,[this].concat(o)))).state={joinRoomProgress:"prog_init"},r.onJoinRoomButtonClick=function(){r.onJoinRoomPending();var e=r.props,t=e.room;(0,e.joinRoom)(t&&t.roomId,r.onJoinRoomSuccess,r.onJoinRoomFail)},r.onJoinRoomPending=function(){r.setState({joinRoomProgress:"prog_pending"})},r.onJoinRoomSuccess=function(){r.setState({joinRoomProgress:"prog_success"})},r.onJoinRoomFail=function(){r.setState({joinRoomProgress:"prog_fail"})},r}return Object(F.a)(t,e),Object(S.a)(t,[{key:"render",value:function(){return o.a.createElement(nr,Object.assign({onJoinRoomButtonClick:this.onJoinRoomButtonClick},this.props,this.state))}}]),t}(o.a.Component),ar=Object(c.b)(null,{joinRoom:Wt})((function(e){return o.a.createElement(or,e)})),sr=(r(399),function(e,t,r){return o.a.createElement("div",{className:"d-flex flex-column room-content-container"},function(e,t){return o.a.createElement(o.a.Fragment,null,o.a.createElement(Xt,{room:e,className:"room-content-header"}),o.a.createElement("div",{className:"room-content-body"},o.a.createElement(Yt,{room:e})),o.a.createElement("div",{className:"room-content-footer"},o.a.createElement(At,{onFormSubmit:t})))}(e,t))}),ir=function(e){var t=e.error,r=e.room,n=e.currentUser,a=e.onSendMessageButtonClick;return t?function(e){return e.status,o.a.createElement("div",null,"Unexpected Error")}(t):r?function(e,t){return!!(e&&e.members&&t)&&-1!==e.members.findIndex((function(e){return e.user&&e.user._id===t}))}(r,n&&n._id)?sr(r,a):o.a.createElement(ar,{room:r}):o.a.createElement("div",{className:"centered-content"},o.a.createElement("h2",null,"Please wait while the Room is loading..."),o.a.createElement(le.a,{size:"lg",animation:"border"}))},cr=function(e,t,r,n){!function(e,t,r,n){ke.post("/api/rooms/".concat(e,"/messages"),{message:t}).then(r,n)}(e,t,(function(t){!function(e,t){Et.emit(ft,gt,e,t)}(e,t._id),r(t)}),n)},lr=function(e){function t(){var e,r;Object(j.a)(this,t);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(r=Object(P.a)(this,(e=Object(C.a)(t)).call.apply(e,[this].concat(o)))).state={error:null},r.onRoomFetchFail=function(e){var t=e.response;r.setState({error:t})},r.onSendMessageButtonClick=function(e){var t=e.message;if(!t||0===t.trim().length)return null;var n=r.props.room;cr(n.roomId,t,r.onSendMessageSuccess,r.onSendMessageFailure)},r.onSendMessageSuccess=function(e){r.setState({room:e.data})},r.onSendMessageFailure=function(e){var t=e.response;r.setState({error:t})},r}return Object(F.a)(t,e),Object(S.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props,r=t.fetchRoom,n=t.roomId;console.log("roomId: ",n),function(e,t){Et.on(ft,(function(){for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];console.log("Message Event: ",n);var a=n[0];if(a===gt){var s=n[1];s.roomId===e&&t(s)}}))}(n,(function(t){console.log("new message: ",t),r(n,e.onRoomFetchSuccess,e.onRoomFetchFail)})),r(n,(function(){}),this.onRoomFetchFail)}},{key:"componentDidUpdate",value:function(){var e,t,r=this.props.room;r&&(e=r.roomId,t=function(){},Et.emit(dt,pt,e,t))}},{key:"render",value:function(){var e=this.props,t=e.currentUser,r=e.room;return o.a.createElement(ir,Object.assign({currentUser:t,room:r,onSendMessageButtonClick:this.onSendMessageButtonClick},this.state))}}]),t}(o.a.Component),mr=Object(c.b)((function(e,t){return{currentUser:e.user&&e.user.user,room:e.rooms[t.roomId]}}),{fetchRoom:function(e,t,r){return function(n){Ue(e).then((function(e){var r=e.data;t(r),n({type:"FETCH_ROOM",payload:r})})).catch(r)}}})((function(e){return o.a.createElement(lr,e)})),ur=r(107),dr=r(39),pr=r.n(dr),fr=(r(400),function(e,t){return o.a.createElement(V.a,{fluid:!0,className:"d-flex flex-column align-items-center"},o.a.createElement("div",{className:"title empty-room-list-title"},e),o.a.createElement("div",{className:"subtitle empty-room-list-subtitle"},t))}),gr=function(e){var t=e.isSearchResult;return o.a.createElement(V.a,{className:"centered-content compensate-header"},t?fr("No rooms matching your search query","Try checking spelling and other possible errors, if any"):function(){var e=o.a.createElement(Kt.a,null,o.a.createElement(U,{size:"sm",className:"empty-room-list-subtitle"},"Create a room"),o.a.createElement(x,{size:"sm",variant:"outline-primary",className:"empty-room-list-subtitle"},"Join a room by Id"));return fr("There are no public rooms available",e)}())},br=r(206),hr=function(e){var t=e.room,r=e.isCurrentUserRoomMember,n=e.isCurrentUserRoomAdmin,a=Object(h.a)(e,["room","isCurrentUserRoomMember","isCurrentUserRoomAdmin"]);return r?o.a.createElement(Kt.a,null,function(e){var t=e.roomId?e.roomId:"";return o.a.createElement(w.b,{to:"/rooms/".concat(t),className:"btn btn-outline-primary"},"Open")}(t),n?function(e){return o.a.createElement(T,{room:e},"Delete")}(t):null):function(){var e=a.joinRoomProgress,r=a.onJoinRoomButtonClick;return function(e,t){return o.a.createElement(er,{progress:e,propsProgressInitial:{label:"Join",onClick:t}})}(e,(function(){return r(t?t.roomId:"")}))}()},Er=function(e){function t(){var e,r;Object(j.a)(this,t);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(r=Object(P.a)(this,(e=Object(C.a)(t)).call.apply(e,[this].concat(o)))).getMemberReferenceOfCurrentUser=function(){var e=r.props,t=e.room,n=e.currentUser;if(!t||!n)return null;return t.members.find((function(e){return e&&e.user&&e.user._id===n._id}))},r.isCurrentUserRoomMember=function(e){return!pr()(e)},r.isCurrentUserRoomAdmin=function(e){return!!r.isCurrentUserRoomMember(e)&&"admin"===e.memberType},r}return Object(F.a)(t,e),Object(S.a)(t,[{key:"render",value:function(){var e=this.getMemberReferenceOfCurrentUser();return o.a.createElement(hr,Object.assign({isCurrentUserRoomMember:this.isCurrentUserRoomMember(e),isCurrentUserRoomAdmin:this.isCurrentUserRoomAdmin(e)},this.props))}}]),t}(o.a.Component),vr=Object(c.b)((function(e){return{currentUser:e.user.user,isUserLoggedIn:e.user.isLoggedIn}}))(Er),Or=function(e){if(!e)return"<unknown>";var t=new Date(e);return function(e,t){if(e<t){throw new Error("[ISODateToReadableString.getAppropriateTimeDifferenceText] First date argument must be greater than the second argument")}var r=function(e,t){var r=e.getYear()-t.getYear();if(r>0)return{unit:r>1?"years":"year",difference:r};var n=e.getMonth()-t.getMonth();if(n>0)return{unit:n>1?"months":"month",difference:n};var o=e.getDate()-t.getDate();if(o>0)return{unit:o>1?"days":"day",difference:o};var a=e.getHours()-t.getHours();if(a>0)return{unit:a>1?"hrs":"hr",difference:a};var s=e.getMinutes()-t.getMinutes();if(s>0)return{unit:s>1?"mins":"min",difference:s};var i=e.getSeconds()-t.getSeconds();return i>0?{unit:i>1?"secs":"sec",difference:i}:void 0}(e,t);return r?"".concat(r.difference).concat(r.unit," ago"):"just now"}(new Date,t)},yr=function(e){var t=e.room,r=e.onJoinRoomButtonClick,n=e.joinRoomProgress;Object(h.a)(e,["room","onJoinRoomButtonClick","joinRoomProgress"]);if(!t)return null;return o.a.createElement(br.a,{className:"px-0"},o.a.createElement(V.a,{fluid:!0,className:"d-flex flex-row justify-content-between"},o.a.createElement("div",{className:"text-overflow-ellipses"},o.a.createElement("h5",{className:"max-width-100 text-overflow-ellipses"},o.a.createElement(w.b,{to:"/rooms/".concat(t.roomId)},t.name)),function(){var e=t.createdBy,r=e?e.username:"<unknown>",n=Or(t.createdAt);return o.a.createElement("span",{className:"max-width-100 subtitle"},"Created ",n," by ",r)}()),o.a.createElement("div",null,o.a.createElement(vr,{room:t,onJoinRoomButtonClick:r,joinRoomProgress:n}))))},Rr=function(e){function t(){var e,r;Object(j.a)(this,t);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(r=Object(P.a)(this,(e=Object(C.a)(t)).call.apply(e,[this].concat(o)))).state={joinRoomProgress:"prog_init"},r.onJoinRoomPending=function(){r.setState({joinRoomProgress:"prog_pending"})},r.onJoinRoomSuccess=function(){r.setState({joinRoomProgress:"prog_success"})},r.onJoinRoomFailure=function(){r.setState({joinRoomProgress:"prog_fail"})},r.onJoinRoomButtonClick=function(e){r.onJoinRoomPending(),r.props.joinRoom(e,r.onJoinRoomSuccess,r.onJoinRoomFailure)},r}return Object(F.a)(t,e),Object(S.a)(t,[{key:"render",value:function(){return o.a.createElement(yr,Object.assign({onJoinRoomButtonClick:this.onJoinRoomButtonClick},this.state,this.props))}}]),t}(o.a.Component),jr=Object(c.b)(null,{joinRoom:Wt})((function(e){return o.a.createElement(Rr,e)})),Sr=r(72),Pr=function(e){function t(){var e,r;Object(j.a)(this,t);for(var n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return(r=Object(P.a)(this,(e=Object(C.a)(t)).call.apply(e,[this].concat(a)))).renderRadioButton=function(e){var t=e.input,r=Object(h.a)(e,["input"]);return o.a.createElement(Sr.a,Object.assign({},r,t))},r}return Object(F.a)(t,e),Object(S.a)(t,[{key:"renderRadioButtonFields",value:function(){var e=this;return[{label:"By name (ascending)",value:"name-asc",id:1},{label:"By name (descending)",value:"name-des",id:2},{label:"By date of creation (oldest first)",value:"date-asc",id:3},{label:"By date of creation (newest first)",value:"date-des",id:4}].map((function(t){var r=t.id,n=Object(h.a)(t,["id"]);return o.a.createElement(Ze.a,Object.assign({component:e.renderRadioButton,type:"radio",name:"sortBy",key:r,checked:1===r,required:!0},n))}))}},{key:"render",value:function(){var e=this.props,t=e.handleSubmit,r=e.onFormSubmit;return o.a.createElement(We.a,{id:"rooms-sort-form",onSubmit:t(r)},this.renderRadioButtonFields(),o.a.createElement("hr",null),o.a.createElement(V.a,{fluid:!0,className:"text-right"},o.a.createElement(N.a,{size:"sm",variant:"outline-primary",type:"submit",form:"rooms-sort-form"},"Done")))}}]),t}(o.a.Component),Cr=Object($e.a)({form:"rooms-sort-form",initialValues:{sortBy:"name-asc"},destroyOnUnmount:!1})(Pr),Fr=function(e){var t=e.onSortFormSubmit;return o.a.createElement(W,{menu:o.a.createElement(Cr,{onFormSubmit:function(e){document.body.click(),t(e)}}),triggerComponent:o.a.createElement(de,{icon:o.a.createElement(q.a,{icon:H.k}),iconPos:0,className:"no-highlight-around-element",variant:"secondary",size:"sm"},"Sort By"),show:!0})},wr=function(e){var t=e.onSearchFieldInputChange;return o.a.createElement(se.a,{className:"rounded"},o.a.createElement(se.a.Prepend,null,o.a.createElement(se.a.Text,null,o.a.createElement(q.a,{icon:H.i}))),o.a.createElement($.a,{name:"searchQuery",placeholder:"Search Rooms",onChange:t}))},Ir=function(e){var t=e.onSortFormSubmit,r=e.onSearchFieldInputChange;return o.a.createElement(V.a,{fluid:!0,className:"room-page-sub-header d-flex align-items-center justify-content-between px-sm-0 mx-sm-0"},o.a.createElement(V.a,{fluid:!0},o.a.createElement(Fr,{onSortFormSubmit:t})),o.a.createElement(V.a,{fluid:!0},o.a.createElement(wr,{onSearchFieldInputChange:r})))},Nr=r(412),_r=function(e){var t=e.totalRooms,r=e.itemsPerPage,n=e.currentPageNumber,a=e.setCurrentPageNumber,s=Math.ceil(t.length/r);return o.a.createElement(V.a,{fluid:!0,className:"d-flex flex-column align-items-center mt-5"},o.a.createElement("p",null,"Showing Page ",n," of ",s),o.a.createElement(Nr.a,{className:"mx-auto"},o.a.createElement(Z,{label:"First page",id:"pagination-first",triggerComponent:o.a.createElement(Nr.a.First,{onClick:function(){a(1)}})}),o.a.createElement(Z,{triggerComponent:o.a.createElement(Nr.a.Prev,{onClick:function(){a(Math.max(n-1,1))}}),label:"Previous Page",id:"pagination-prev"}),function(){for(var e=[],t=function(t){e.push(o.a.createElement(Nr.a.Item,{active:n===t,key:t,id:t,onClick:function(){a(t)}},t))},r=1;r<=s;r++)t(r);if(e.length>10){var i=function(e,t){var r=function(e){return e-1<4?0:e-1-4}(e),n=function(e){return e-1+4}(e),o={left:r,right:n};return 0!==r&&n>=t&&(o.left-=n+1-(t-1)),0===r&&(o.right+=5-(e-1)),{leftOffset:o.left,rightOffset:o.right}}(n,e.length),c=i.leftOffset,l=i.rightOffset,m=[l<e.length?o.a.createElement(Nr.a.Ellipsis,{key:"ellipsis-right"}):null],u=[c>0?o.a.createElement(Nr.a.Ellipsis,{key:"ellipsis-left"}):null];return[].concat(u,Object(ur.a)(e.slice(c,l+1)),m)}return e}(),o.a.createElement(Z,{triggerComponent:o.a.createElement(Nr.a.Next,{onClick:function(){a(Math.min(n+1,s))}}),label:"Next Page",id:"pagination-next"}),o.a.createElement(Z,{triggerComponent:o.a.createElement(Nr.a.Last,{onClick:function(){a(s)}}),label:"Last Page",id:"pagination-last"})))},Mr=function(e){var t=e.roomsToDisplay,r=e.isSearchResult,n=e.onSortFormSubmit,a=e.onSearchFieldInputChange,s=e.setCurrentPageNumber,i=Object(h.a)(e,["roomsToDisplay","isSearchResult","onSortFormSubmit","onSearchFieldInputChange","setCurrentPageNumber"]);return o.a.createElement(V.a,{fluid:!0,className:"pb-5 mb-5"},o.a.createElement(Ir,{onSortFormSubmit:n,onSearchFieldInputChange:a}),pr()(t)?o.a.createElement(gr,{isSearchResult:r}):o.a.createElement(Ut.a,{variant:"flush",className:"mx-0 mt-3"},t.map((function(e){return o.a.createElement(jr,{room:e,key:e.roomId})}))),pr()(t)?null:o.a.createElement(_r,Object.assign({},i,{setCurrentPageNumber:function(e){s(e)}})))},kr=function(e,t){return e&&e.name?t&&t.name?e.name.localeCompare(t.name):e?1:-1:t?-1:1},Lr=function(e,t){return e&&e.createdAt?t&&t.createdAt?e.createdAt.localeCompare(t.createdAt):e?1:-1:t?-1:1},Ar=new(function(){function e(t){Object(j.a)(this,e),this.loggerKey=t}return Object(S.a)(e,[{key:"debug",value:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];(e=console).log.apply(e,[this.loggerKey].concat(r))}}]),e}())("[RoomListContainer] "),Ur=function(e){function t(){var e,r;Object(j.a)(this,t);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(r=Object(P.a)(this,(e=Object(C.a)(t)).call.apply(e,[this].concat(o)))).onRoomFetchFail=function(e){var t=e.response;Ar.debug("RoomList fetch fail: ",t)},r.getSortedRoomList=function(e){var t=r.props.roomListDisplaySettings.sortBy;if(!e)return[];switch(t){case"name-des":return e.sort(kr).reverse();case"date-asc":return e.sort(Lr);case"date-des":return e.sort(Lr).reverse();case"name-asc":default:return e.sort(kr)}},r.onSortFormSubmit=function(e){r.props.setSortTechnique(e.sortBy)},r.onSearchFieldInputChange=function(e){r.props.setSearchQuery(e.target.value)},r.getPaginatedRoomList=function(e){var t=r.props.roomListDisplaySettings,n=t.itemsPerPage,o=t.currentPageNumber;if(e.length<=n)return e;var a=n*(o-1),s=Math.min(a+n,e.length);return e.slice(a,s)},r.getSearchQuery=function(){var e=r.props.roomListDisplaySettings.searchQuery;return e&&e.toLowerCase().trim()},r.filterRoomListBySearchQuery=function(e,t){return t?e.filter((function(e){var r=e&&e.name;return r&&r.toLowerCase().includes(t)})):e},r.getRooms=function(e){var t=Object(ur.a)(r.props.rooms);return r.getSortedRoomList(r.filterRoomListBySearchQuery(t,e))},r}return Object(F.a)(t,e),Object(S.a)(t,[{key:"componentDidMount",value:function(){this.props.fetchPublicRooms(this.onRoomFetchFail)}},{key:"render",value:function(){var e=this.props,t=e.roomListDisplaySettings,r=e.setCurrentPageNumber,n=this.getSearchQuery(),a=this.getRooms(n),s=this.getPaginatedRoomList(a);return o.a.createElement(Mr,Object.assign({totalRooms:a,roomsToDisplay:s,isSearchResult:!pr()(n),onSortFormSubmit:this.onSortFormSubmit,onSearchFieldInputChange:this.onSearchFieldInputChange,setCurrentPageNumber:r},t))}}]),t}(o.a.Component),xr=Object(c.b)((function(e){return{rooms:Object.values(e.rooms),roomListDisplaySettings:e.roomListDisplaySettings}}),{fetchPublicRooms:function(e){return function(t){return Ne.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:n=function(e){t({type:"FETCH_PUBLIC_ROOMS",payload:e.data})},o=e,ke.get("/api/rooms").then(n,o);case 1:case"end":return r.stop()}var n,o}))}},setSortTechnique:function(e){return{type:"SET_ROOM_LIST_SORT_TECHNIQUE",payload:e}},setCurrentPageNumber:function(e){return{type:"SET_ROOM_LIST_CURRENT_PAGE",payload:e}},setSearchQuery:function(e){return{type:"SET_ROOM_LIST_SEARCH_QUERY",payload:e}}})(Ur),Tr=(r(401),function(e){if(e)return o.a.createElement(ue.a,function(e){var t=e?{xs:12,sm:12,className:"h-100"}:{};return Object(p.a)({},{xl:7,lg:7,md:7},{},t)}(e),o.a.createElement(mr,{roomId:e,key:e}))}),Dr=function(e){var t=e.match.params.id,r=o.a.createElement(V.a,{fluid:!0,className:"pl-0 pr-0 room-page-container"},o.a.createElement(me.a,{className:"mx-0 no-gutters h-100"},function(e){return o.a.createElement(ue.a,function(e){return e?{xl:5,lg:5,md:5,sm:0,xs:0,className:"d-none d-md-block ".concat("overflow-auto h-100")}:{className:"overflow-auto h-100"}}(e),o.a.createElement(xr,null))}(t),Tr(t)));return ze(r)},Jr=function(){return o.a.createElement(w.a,null,o.a.createElement(I.d,null,o.a.createElement(I.b,{exact:!0,path:"/",component:Xe}),o.a.createElement(I.b,{exact:!0,path:"/rooms/:id?",component:Dr}),o.a.createElement(I.b,{exact:!0,path:"/login",component:lt}),o.a.createElement(I.b,{exact:!0,path:"/register",component:It})))},Br=function(e){return e.serverConnectionFailed?o.a.createElement("div",{className:"centered-content"},"Cannot Connect To Server"):o.a.createElement(Jr,null)},Vr=function(e){function t(){var e,r;Object(j.a)(this,t);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(r=Object(P.a)(this,(e=Object(C.a)(t)).call.apply(e,[this].concat(o)))).state={serverConnectionFailed:!1},r.onServerConnected=function(){r.setState({serverConnectionFailed:!1})},r.onServerDisconnected=function(){r.setState({serverConnectionFailed:!0})},r}return Object(F.a)(t,e),Object(S.a)(t,[{key:"componentDidMount",value:function(){var e,t=this.props,r=t.connectToServer,n=t.updateUser;r(this.onServerDisconnected),e=this.onServerDisconnected,Et.on("disconnect",e),function(e){Et.on("connect",e)}(this.onServerConnected),n()}},{key:"render",value:function(){return o.a.createElement(Br,this.state)}}]),t}(o.a.Component),Gr={connectToServer:function(e){return function(t){return Ne.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Ne.a.awrap(vt(e));case 2:t({type:"CONNECT_TO_SERVER",payload:{connected:!0}});case 3:case"end":return r.stop()}}))}},updateUser:function(){return function(e){return Ne.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:r=function(t){return De(t,e)},n=function(e){var t=e.response;return console.log("Get current user fail: ",t)},ke.get("/api/user/").then(r,n);case 1:case"end":return t.stop()}var r,n}))}}},qr=Object(c.b)(null,Gr)((function(e){var t=e.connectToServer,r=e.updateUser;return o.a.createElement(Vr,{connectToServer:t,updateUser:r})})),Hr=r(73),Qr=function(e){var t=e.visible,r=e.hideModal,n=e.header,a=e.content,s=e.actions;return o.a.createElement(Hr.a,{show:t,onHide:r,centered:!0},o.a.createElement(Hr.a.Header,{closeButton:!0,onHide:r},o.a.createElement(Hr.a.Title,null,n)),o.a.createElement(Hr.a.Body,null,a),o.a.createElement(Hr.a.Footer,null,s))},zr=(r(402),function(e){var t=e.input,r=e.meta,n=r.touched&&r.error,a=!r.pristine&&!n,s=[{label:"Private",value:"private"},{label:"Public",value:"public"},{label:"Unlisted",value:"unlisted"}].map((function(e){return o.a.createElement(We.a.Group,{controlId:"roomType-".concat(e.value),key:e.value},o.a.createElement(se.a,null,o.a.createElement(We.a.Check,Object.assign({},t,e,{type:"radio",isInvalid:n,isValid:a})),o.a.createElement(se.a.Append,null,function(e){var t=function(e){var t=o.a.createElement(q.a,{icon:H.g});return o.a.createElement(Z,Object.assign({triggerComponent:t},e))};switch(e){case"private":return t({id:"private-room-opt",label:"Private rooms require permission to join and are not listed publicly"});case"unlisted":return t({id:"private-room-opt",label:"Unlisted rooms can be joined by anyone but are not listed publicly"});case"public":return t({id:"private-room-opt",label:"Public rooms are listed publicly and can be joined by anyone"})}}(e.value))))}));return o.a.createElement(We.a.Group,{controlId:"create-room-form-type"},o.a.createElement(We.a.Label,null,o.a.createElement("strong",null,"Select Room Type:")),s,n&&o.a.createElement(Q.a,{variant:"danger"},r.error))}),Yr=function(e){var t=e.input,r=e.meta,n=r.touched&&r.error,a=!r.pristine&&!n;return o.a.createElement(Ke.a,{controlId:"create-room-form-name"},o.a.createElement(We.a.Label,null,o.a.createElement("strong",null,e.label)),o.a.createElement($.a,Object.assign({},e,t,{isInvalid:n,isValid:a})),o.a.createElement(We.a.Control.Feedback,{size:"lg",type:"invalid"},r.error))},Xr=function(e){var t=e.onFormSubmit;return o.a.createElement(We.a,{noValidate:!0,id:"create-room-form",onSubmit:t},o.a.createElement(Ze.a,{component:Yr,name:"roomName",label:"Enter Room Name:",placeholder:"Example: The Mystical Room",required:!0}),o.a.createElement("hr",null),o.a.createElement(Ze.a,{component:zr,name:"roomType"}))},Wr=Object($e.a)({form:"createRoomForm",validate:function(e){var t={};return e.roomName||(t.roomName="Room name cannot be empty"),e.roomType||(t.roomType="Please choose one of the room types above"),t}})((function(e){var t=e.handleSubmit,r=e.onFormSubmit;return o.a.createElement(Xr,{onFormSubmit:t(r)})})),Kr=function(e){var t=e.isModalVisible,r=e.hideModal,n=e.createRoomFormData,a=e.createRoomProgress,s=e.onFormSubmit;return o.a.createElement(Qr,{header:"Create Room",actions:function(){var e=n&&n.syncErrors;return o.a.createElement(o.a.Fragment,null,o.a.createElement(N.a,{variant:"secondary",onClick:r},"Cancel"),o.a.createElement(Zt,{progress:a,form:"create-room-form",type:"submit",disabled:e,className:"cursor-".concat(e?"not-allowed":"pointer")}))}(),content:o.a.createElement(Wr,{onFormSubmit:s}),visible:t,hideModal:r})},Zr=function(e){function t(){var e,r;Object(j.a)(this,t);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(r=Object(P.a)(this,(e=Object(C.a)(t)).call.apply(e,[this].concat(o)))).state={createRoomProgress:"prog_init"},r.onCreateRoomPending=function(){r.setState({createRoomProgress:"prog_pending"})},r.onCreateRoomSuccess=function(){r.setState({createRoomProgress:"prog_success"})},r.onCreateRoomFailure=function(){r.setState({createRoomProgress:"prog_fail"})},r.onFormSubmit=function(e){var t=e.roomName,n=e.roomType;r.onCreateRoomPending(),(0,r.props.createRoom)(t,n,r.onCreateRoomSuccess,r.onCreateRoomFailure)},r}return Object(F.a)(t,e),Object(S.a)(t,[{key:"render",value:function(){return o.a.createElement(Kr,Object.assign({onFormSubmit:this.onFormSubmit},this.state,this.props))}}]),t}(o.a.Component),$r=Object(c.b)((function(e){return{isModalVisible:e.modal.isModalOpen&&"CreateRoom"===e.modal.modalName,createRoomFormData:e.form.createRoomForm}}),{createRoom:function(e,t,r,n){return function(o){return Ne.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:xe(e,t,(function(e){o({type:"CREATE_ROOM",payload:e.data}),r()}),n);case 1:case"end":return a.stop()}}))}},hideModal:M})((function(e){return o.a.createElement(Zr,e)})),en=function(e){var t=e.input,r=e.label,n=e.meta,a=e.roomAlreadyJoinedError,s=Object(h.a)(e,["input","label","meta","roomAlreadyJoinedError"]),i=n.touched,c=n.error,l=n.pristine,m=n.asyncValidating,u=c&&c.isAsyncValidationError||i&&c||a,d=a||c&&(c.isAsyncValidationError?c.reason:c);return o.a.createElement(Ke.a,{controlId:"join-room"},o.a.createElement(ae.a,null,r),o.a.createElement($.a,Object.assign({className:m?"input-loading":"",isValid:!m&&!l&&!u,isInvalid:u},t,s)),o.a.createElement($.a.Feedback,{type:"invalid"},d))},tn=function(e){return pr()(e)?"RoomId is required":void 0},rn=function(e){var t=e.onFormSubmit,r=e.roomAlreadyJoinedError;return o.a.createElement(We.a,{id:"join-room-form",onSubmit:t},o.a.createElement(Ze.a,{component:en,name:"roomId",label:"Enter Room Id",placeholder:"X-X-X-X",roomAlreadyJoinedError:r,validate:tn}))},nn=function(e,t){return{roomId:{reason:e,isAsyncValidationError:!0,isPrivateRoomError:t}}},on=Object($e.a)({form:"joinRoomForm",asyncValidate:function(e){return new Promise((function(t,r){if(pr()(e.roomId))return r(nn("No rooms matching that roomId"));Ue(e.roomId).then(t).catch((function(e){var t=e.response;r(function(e){switch(e.status){case 403:return nn("This is a private room. You need to send a join request",!0);case 404:return nn("No rooms matching that roomId");default:return nn("Some error ocurred; Please try again after sometime")}}(t))}))}))},asyncChangeFields:["roomId"]})((function(e){var t=e.handleSubmit,r=e.onFormSubmit,n=e.roomAlreadyJoinedError;return o.a.createElement(rn,{onFormSubmit:t(r),roomAlreadyJoinedError:n})})),an=function(e){var t=e.roomAlreadyJoinedError,r=e.isModalVisible,n=e.hideModal,a=e.onFormSubmit,s=e.joinRoomFormData,i=e.joinRoomProgress;return o.a.createElement(Qr,{header:"Join Room By Id",actions:o.a.createElement(o.a.Fragment,null,o.a.createElement(N.a,{onClick:n,variant:"outline-secondary"},"Cancel"),function(){var e=s&&s.asyncErrors,r=s&&(s.syncErrors||e||s.asyncValidating)||t,n={type:"submit",form:"join-room-form",disabled:r,className:"cursor-".concat(r?"not-allowed":"pointer")};return e&&e.roomId.isPrivateRoomError?o.a.createElement(rr,{progress:i,propsProgressInitial:n}):o.a.createElement(er,{progress:i,propsProgressInitial:n})}()),content:o.a.createElement(on,{onFormSubmit:a,roomAlreadyJoinedError:t}),visible:r,hideModal:n})},sn=function(e){function t(){var e,r;Object(j.a)(this,t);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(r=Object(P.a)(this,(e=Object(C.a)(t)).call.apply(e,[this].concat(o)))).state={joinRoomProgress:"prog_init",roomAlreadyJoinedError:null},r.onJoinRoomPending=function(){r.setState({joinRoomProgress:"prog_pending"})},r.onJoinRoomSuccess=function(){r.setState({joinRoomProgress:"prog_success"})},r.onJoinRoomFailure=function(){r.setState({joinRoomProgress:"prog_fail"})},r.onJoinRoomFormSubmit=function(e){var t=e.roomId;r.onJoinRoomPending(),r.props.joinRoom(t,r.onJoinRoomSuccess,r.onJoinRoomFailure)},r}return Object(F.a)(t,e),Object(S.a)(t,[{key:"componentDidUpdate",value:function(){var e=this;if(!this.state.roomAlreadyJoinedError){var t=this.props,r=t.joinRoomFormData,n=t.currentUserId,o=r||{};if(!(o.syncErrors||o.asyncErrors||o.asyncValidating)){var a=o.values&&o.values.roomId;Ue(a).then((function(t){(function(e,t){return!!(e&&e.members&&t)&&-1!==e.members.findIndex((function(e){return e.user&&e.user._id===t}))})(t.data,n)&&e.setState({roomAlreadyJoinedError:"You are already a member of this room"})})).catch()}}}},{key:"render",value:function(){return o.a.createElement(an,Object.assign({onFormSubmit:this.onJoinRoomFormSubmit},this.props,this.state))}}]),t}(o.a.Component),cn=Object(c.b)((function(e){var t=e.user;return{isModalVisible:e.modal.isModalOpen&&"JoinRoom"===e.modal.modalName,joinRoomFormData:e.form.joinRoomForm,currentUserId:t&&t.user&&t.user._id}}),{hideModal:M,joinRoom:Wt})((function(e){return o.a.createElement(sn,e)})),ln=function(e){var t=e.input,r=e.label,n=Object(h.a)(e,["input","label"]);return o.a.createElement(Ke.a,{controlId:"delete-room-form-name"},o.a.createElement(We.a.Label,null,o.a.createElement("strong",null,r)),o.a.createElement($.a,Object.assign({},n,t)))},mn=function(e){var t=e.onFormSubmit,r=e.validate;return o.a.createElement(We.a,{noValidate:!0,id:"delete-room-form",onSubmit:t},o.a.createElement(Ze.a,{component:ln,name:"roomName",label:"Room Name:",placeholder:"Enter Room name here",validate:r,required:!0}))},un=function(e){function t(e){var r,n;return Object(j.a)(this,t),(r=Object(P.a)(this,Object(C.a)(t).call(this,e))).deleteRoomFieldValidate=(n=r.props.room,function(e){return n&&e===n.name?void 0:"Room name not equal"}),r}return Object(F.a)(t,e),Object(S.a)(t,[{key:"render",value:function(){var e=this.props,t=e.room,r=e.onFormSubmit,n=e.deleteRoomForm,a=e.handleSubmit;return o.a.createElement(mn,{room:t,deleteRoomFormData:n,onFormSubmit:a(r),validate:this.deleteRoomFieldValidate})}}]),t}(o.a.Component),dn=Object($e.a)({form:"delete-room-form"})(un),pn=function(e){var t=e.deleteRoomProgress,r=e.deleteRoomFormData,n=e.modalProps,a=e.isModalVisible,s=e.hideModal,i=e.onFormSubmit;return o.a.createElement(Qr,{header:"Delete Room",actions:function(){var e="prog_success"===t||"prog_fail"===t?"Go Back":"Cancel";return o.a.createElement(o.a.Fragment,null,o.a.createElement(N.a,{variant:"outline-secondary",onClick:s},e),function(){var e=r?r.syncErrors:null,n=e&&e.roomName;return o.a.createElement($t,{progress:t,propsProgressInitial:{type:"submit",form:"delete-room-form",variant:"danger",disabled:n,className:"cursor-".concat(n?"not-allowed":"pointer")}})}())}(),content:function(){var e=n.room,t=e?e.name:"<unknown>";return o.a.createElement(me.a,null,o.a.createElement(ue.a,{sm:12},o.a.createElement(dn,{onFormSubmit:i,room:e})),o.a.createElement(ue.a,null,o.a.createElement("p",{className:"word-wrap-break-word"},"To delete the room ",o.a.createElement("strong",null,t)," type in the name of the room above")))}(),visible:a,hideModal:s})},fn=function(e){function t(){var e,r;Object(j.a)(this,t);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(r=Object(P.a)(this,(e=Object(C.a)(t)).call.apply(e,[this].concat(o)))).onDeleteRoomFormSubmit=function(){var e=r.props,t=e.onDeleteRoomPending,n=e.onDeleteRoomSuccess,o=e.onDeleteRoomFail,a=e.deleteRoom,s=e.modalProps.room;t(),a(s.roomId,n,o)},r}return Object(F.a)(t,e),Object(S.a)(t,[{key:"render",value:function(){var e=this.props,t=e.deleteRoomForm,r=e.deleteRoomProgress,n=e.modalProps,a=e.isModalVisible,s=e.hideModal;return o.a.createElement(pn,{deleteRoomFormData:t,deleteRoomProgress:r,modalProps:n,isModalVisible:a,hideModal:s,onFormSubmit:this.onDeleteRoomFormSubmit})}}]),t}(o.a.Component),gn=Object(c.b)((function(e){var t=e.modal;return{isModalVisible:t.isModalOpen&&"DeleteRoom"===t.modalName,modalProps:t.modalProps,deleteRoomForm:e.form["delete-room-form"]}}),{hideModal:M,deleteRoom:function(e,t,r){return function(n){return Ne.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:Te(e).then((function(r){t(),n({type:"DELETE_ROOM",payload:e})})).catch(r);case 1:case"end":return o.stop()}}))}}})(fn),bn=function(e){function t(){var e,r;Object(j.a)(this,t);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(r=Object(P.a)(this,(e=Object(C.a)(t)).call.apply(e,[this].concat(o)))).state={deleteRoomProgress:"prog_init"},r.onDeleteRoomPending=function(){r.setState({deleteRoomProgress:"prog_pending"})},r.onDeleteRoomSuccess=function(){r.setState({deleteRoomProgress:"prog_success"})},r.onDeleteRoomFail=function(){r.setState({deleteRoomProgress:"prog_fail"})},r}return Object(F.a)(t,e),Object(S.a)(t,[{key:"render",value:function(){return o.a.createElement(gn,Object.assign({onDeleteRoomPending:this.onDeleteRoomPending,onDeleteRoomSuccess:this.onDeleteRoomSuccess,onDeleteRoomFail:this.onDeleteRoomFail},this.state))}}]),t}(o.a.Component),hn=function(e){var t=e.room,r=e.isModalVisible,n=e.hideModal,a=e.onLeaveRoomButtonClick,s=e.leaveRoomProgress;return o.a.createElement(Qr,{header:"Leave Room",actions:function(){var e="prog_success"===s||"prog_fail"===s?"Go Back":"Cancel";return o.a.createElement(o.a.Fragment,null,o.a.createElement(N.a,{variant:"outline-secondary",onClick:n},e),o.a.createElement(tr,{progress:s,propsProgressInitial:{variant:"danger",onClick:a}}))}(),content:function(){var e=o.a.createElement("strong",null,t?t.name:"<unknown>");return o.a.createElement("p",{className:"word-wrap-break-word"},"Are you sure you want to leave the room ",e,"?")}(),visible:r,hideModal:n})},En=Object(c.b)((function(e){var t=e.modal;return{isModalVisible:t.isModalOpen&&"LeaveRoom"===t.modalName,modalProps:t.modalProps}}),{hideModal:M,leaveRoom:function(e,t,r){return function(n,o){if(!e)return r(new Error({response:"Not a room member"}));var a,s,i,c,l=o().user.user._id,m=function(e,t){for(var r=0;r<e.members.length;r++){var n=e.members[r];if(n&&n.user&&n.user._id===t)return n}}(e,l);if(!m)return r(new Error({response:"Not a room member"}));(a=e.roomId,s=m._id,ke.delete("/api/rooms/".concat(a,"/members/").concat(s)).then(i,c)).then((function(r){n({type:"LEAVE_ROOM",payload:{roomId:e.roomId,updatedMembers:r.data.members}}),t(r)})).catch(r)}}})((function(e){var t=e.modalProps.room,r=Object(h.a)(e,["modalProps"]),n=r.isModalVisible,a=r.hideModal,s=r.leaveRoomProgress;return o.a.createElement(hn,{room:t,hideModal:a,isModalVisible:n,leaveRoomProgress:s,onLeaveRoomButtonClick:function(){var e=r.leaveRoom,n=r.onLeaveRoomPending,o=r.onLeaveRoomSuccess,a=r.onLeaveRoomFail;n(),e(t,o,a)}})})),vn=function(e){function t(){var e,r;Object(j.a)(this,t);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(r=Object(P.a)(this,(e=Object(C.a)(t)).call.apply(e,[this].concat(o)))).state={leaveRoomProgress:"prog_init"},r.onLeaveRoomPending=function(){r.setState({leaveRoomProgress:"prog_pending"})},r.onLeaveRoomSuccess=function(){r.setState({leaveRoomProgress:"prog_success"})},r.onLeaveRoomFail=function(){r.setState({leaveRoomProgress:"prog_fail"})},r}return Object(F.a)(t,e),Object(S.a)(t,[{key:"render",value:function(){return o.a.createElement(En,Object.assign({onLeaveRoomPending:this.onLeaveRoomPending,onLeaveRoomSuccess:this.onLeaveRoomSuccess,onLeaveRoomFail:this.onLeaveRoomFail},this.state))}}]),t}(o.a.Component),On=Object(c.b)((function(e){return{modal:e.modal}}))((function(e){return e.modal.isModalOpen?function(e){switch(e){case"CreateRoom":return o.a.createElement($r,null);case"JoinRoom":return o.a.createElement(cn,null);case"DeleteRoom":return o.a.createElement(bn,null);case"LeaveRoom":return o.a.createElement(vn,null);default:return null}}(e.modal.modalName):null})),yn=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||i.d,Rn=Object(i.e)(R,yn(Object(i.a)(l.a)));s.a.render(o.a.createElement(c.a,{store:Rn},o.a.createElement(qr,null),o.a.createElement(On,null)),document.querySelector("#root"))}},[[233,1,2]]]);
//# sourceMappingURL=main.afb17918.chunk.js.map